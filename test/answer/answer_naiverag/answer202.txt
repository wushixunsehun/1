在HPC4系统上安装CMAQ v5.4的步骤包括加载编译环境、安装关键依赖软件如netcdf-c和netcdf-fortran、配置ioapi以及最终的CMAQ编译。关键软件依赖包括Intel编译器、netcdf库和ioapi库，环境变量需要正确指向这些库的路径，Makefile的修改涉及编译器设置和库路径配置。1. 加载编译环境：在HPC4系统上需要加载Intel编译器和MPI模块，例如使用命令“module add Intel_compiler/19.1.2”和“module add MPI/Intel/IMPI/2019.8.254”，确保编译器和并行计算环境可用。2. 安装netcdf-c和netcdf-fortran：下载netcdf-c和netcdf-fortran源码包，解压后分别进行配置和编译。配置时需指定安装路径，并使用对应的编译器（如icc、ifort）和选项，例如“CC=icc CXX=icc FC=ifort”等。编译完成后，将生成的库文件和头文件安装到指定目录，确保后续步骤可以正确找到这些依赖。3. 配置ioapi：通过git克隆ioapi-3.2源码，进入目录后根据系统环境修改Makeinclude文件，设置编译器为mpiicc、mpiicpc和mpiifort，并调整并行编译选项（如“OMPFLAGS = -qopenmp”）。同时，确保Makefile中的库路径正确指向已安装的netcdf库。4. 环境变量配置：在CMAQ编译前，需设置多个环境变量，如IOAPI_INCL_DIR、IOAPI_LIB_DIR、NETCDF_LIB_DIR、NETCDFF_LIB_DIR等，这些变量应指向ioapi和netcdf的安装目录，确保CMAQ能够正确链接到这些库。5. Makefile修改要点：在CMAQ编译过程中，需要修改config_cmaq.csh文件，设置CMAQ_HOME为项目目录，并在Makefile中调整编译器选项和库路径。例如，在Makeinclude.Linux2_x86_64ifort文件中，需设置CC、CXX、FC为mpiicc、mpiicpc和mpiifort，并确保库路径正确无误。此外，还需处理可能的编译错误，如“unrecognized command line option ‘-m64’”，可通过移除或替换相关选项解决。6. 编译CCTM模块：完成上述步骤后，执行编译脚本开始编译CMAQ的各个模块，包括CCTM模块。编译过程中需确保所有依赖项和环境变量配置正确，避免因路径错误或编译器不兼容导致失败。

