{
    "query": "在Lustre文件系统中，如何利用lnetctl工具进行网络配置的导入、导出及流量数据查看？",
    "summaries": [
        "Lustre 文件系统操作手册介绍了 LNet 控制工具 lnetctl 的使用，包括导入和导出 YAML 配置文件、显示 LNet 流量数据、以及 YAML 语法说明。用户可通过命令如 `lnetctl import --del` 删除配置项，`lnetctl export` 导出配置，`lnetctl stats show` 显示统计信息。YAML 文件支持添加、删除和显示操作，包含网络、接口、路由等配置。LNet 参数通常在 `/etc/modprobe.d/lustre.conf` 中设置，用于配置 NICs 和路由。NID（网络标识符）用于唯一标识节点，格式为 `IP@network_type`，如 `10.67.73.200@tcp`。用户可通过 `lctl list nids` 查看 NID 信息。",
        "Lustre 文件系统操作手册中介绍了 lctl 工具的使用，用于配置、维护和调试 Lustre。lctl 可以在交互模式下运行，支持多种命令如 list nids、ping、network up/down 等，用于网络和设备管理。通过 lctl set param 和 lctl conf param 可设置临时或永久参数，避免直接访问 /proc 文件系统。lctl get param 用于获取参数值，lctl list param 列出所有可设置参数。部分参数可通过 MGS 节点进行全局设置，且支持通配符和递归操作。",
        "本文档介绍了Lustre文件系统中网络配置的相关参数和语法。包括路由条目格式、跳数和优先级的作用、扩展语法的使用方法，以及如何配置acceptor服务和socklnd模块。重点说明了路由条目中网络、跳数、优先级的设置，扩展语法用于指定多个节点或范围，同时提到跳数和优先级在路径选择中的重要性。还涉及网络转发、acceptor的配置选项及其作用，以及socklnd模块的使用和负载平衡功能。"
    ],
    "contents": [
        "| 项来允许非特权端口上的连接。| ||none一不运行acceptor。如果 TCP 连接丢失而服务 || | HAF种原因〈如 LDLM 锁回调或大小警) 需要联系客户端，||| 这可能会阻止客户端接收IRS 4% RPC. || accept port (988) | acceptor监听连接请求的端口号。站点配置中需要 ||| acceptor的所有克氮必须使用相同的端口。|| accept packlog(127) |在起连接队列可能的最大长度。| | accept_ timeout (5, W) | 与对等站所通信时多551\nLustre 文件系统操作手册 译者:这ay许acceptor阳塞的最长时间 (LAPD AAR | | accept proto version|输出连接请求应使用的acceptot协议的版本。默认为最新的|上| acceptot协议版本，但也可以设置为以前的版本，以允许节目| 点与只理解该版本的acceptor协议的节点发起连接。acceptor |||可以处理任何一个版本《〈即它可以接受来和目 旧\" 和 新\" PS | | | 点的连接) 。对于当前版本的acceptor协议〈版本 1), WER ||| acceptor只需要一个本地网络，那么它可以与上日的对等点兼容。| HHH 43.2.1.7. rnet_htable sizecnet_htable_size表示内部 LNet 哈希表配置处理的远程网络数，为整数值。rnet_htable_size用于优化哈希表的大小，并不限制您可以拥有的远程网络的数量。未指定此参数时，默认哈希表大小为 128。(在 Lustre 2.3 中引入)43.2.2. SOCKLND 内核 TCP/IP LNDSOCKLND W% TCP/IP LND (sockind) 是基于连接的，使用 acceptor 通过套接字与其对等和氮建立通信。它文持多个实例,在多个接口间使用动态负载平衡。如果ip2nets或网络模块参数未指定接口，则使用所有非环回 IP REO. ZS AN Ht sock indi BAY 28 fh IP fe口的地址决定",
        "指定的OBD 设备。所有其他命令以此命令所设置的设备为基础。device list 显示本地 Lustre OBD, a/k/a dl.设备操作选项 说明list param [-F|-R]parameter列出 Lustre 或LNet 参数名。557UAE\nLustre 文件系统操作手册这ay选项[parameter ...]一了上get_Param [-n|-N|-F]parameter[parameter ...]-n-Nset param [-n]parameter=value-nconf param [-djdevice fsnameparameter=value译者:说明分别为目录，符号链接和可写文件添加7] ，\"@'或 tt递归列出指定路径下的所有参数。如果未指定param Path，则显示所有参数。从指定路径获取 Lustre 或 LNet 参数值。仅打印参数值而不打印参数名称。仅打印匹配的参数名称而不打印值; 在使用模式时特别有用。指定了-N 时，分别为目录，符号链接和可写文件添加/7 ，'\"8'或\"= '。设置指定路径中 Lustre 或LNet 参数的值。+] EVIE INAH key 名称。通过 MGS 为设备设置永久配置参数。此命令必SSME MGS “WR EjiesF. letl list Param下的所有可写参数 (如Lct1 list_param -Fosc.*.*| grep) 可使用LIct1 conf param进行永久设置，但格式略有不同。conf Param需要先指定设备后指定 obdtype，且不文持通配符。此外，可以添加(或删除) 故障转移节点，也可以设置一些系统范围的参数 (sys.at_max，sys.at_min, sys.at_extra, sys.at_early_margin,sys.at history, sys.timeout, sys.ldlm_ timeout).558\nLustre 文件系统操作手册Re: 李硕选项-d device|fsname.parameteractivatedeactivateabort recovery注意说明对于系统范围的参数，device 将被忽略。删除参数设置〈下次重司时使用默认值)。将值设置为空也会删除参数设置。在停用操作后重新激活导入。此设置仅在重新启动后有效 Chil conf",
        "控制Lustre，从而进行各种配置、维护和调试。44.3.1. 梗概1 lctl [--device devno] commana [args]44.3.2. 说明可以通过发出 loth 命令在交互模式下调用 lctl 实用程序。最和见的 lctl 命令有:1 dl2 dk3 device4 network up|down5 list nids6 ping nidhelp7 quit555\n—————Lustre 文件系统操作手册 译者:这ay获取可用命令的完整列表，请在1ct1提示符下键入heIP。获得有关命令的含义和语法，请键入heIP_ commandq。使用TAB 键可补全命令 〈取诀于编译选项) ，使用上下箭头键可查询命令的历史记录。对于非交互式使用，请使用二次调用，即在连接到设备后运行该命令。44.3.3. 使用 lect 设置参数由于平台的不同，使用 procfs 接口并不总是可以成功访问 Lustre 参数。1ct1l{get,set} param作为独立于平台接口的解决方案，已被 Lustre 引入为可调参数，从而避免直接引用/proc/{fs,sys}/{LIustreInet}。考虑到将来使用的可移植性，请使用 lctl {get,set} param.SOE RSIS THT, FESS HMA TT EEA ctl set_pParam命令设置临时参数 CRI Bl] /proc/{fs,sys}/{lnet, lustre} FINIIA). letl set_param命令使用以下语法:lctl Set Param [-n] [-P] [-d] obdtype.obdname.property—value如:mds# lctl set Param mdt.testfs-MDTO000.identity upcal1l=NONE(在 Lustre 2.5 中引入)使用 -P 选项设置永久参数，使用 -q选项删除永久参数。例如: mgs# 1ct1set param -P mdt.testfs-MDT0000.identity upcall=NONE mgs# lctlset param -P -d mdt.testfs-MDT0000.identity upcall很多参数也可通过 lctl conf param进行永久设置。1Lct1l conf param 通常可用于指定任何在文件/Proc/fs/lLIustre可设置的OBD",
        "配合 Lustre 运行，具体包括了应配置哪些NICs 和路由等。80\nLustre 文件系统操作手册 译者:As大LNet 的参数一般在 /etc/modprobe.d/lustre.conf 文件中指定。在 RHELS和 SLES10 之前，这些参数可能被存在/etc/modqprobe.conf文件中，后被弃用。/etc/modprobe.d/lustre.conf 是一个单独的文件，简化了 Lustre 网络配置的管理和分发。该文件包含了一个或多个语法如下的条目—options lnet parameter=value指定用于 Lustre 的网络端口，设置networks 参数或ip2nets人参数 (一次只指定一个参数) :。 networks -指定使用的网络。 ip2nets -列出所有全局可用的网络 CIP 地址范围指定某一网络) LNet 通过地址列表匹配查找来识别本地可用的网络。设置网络间的路由，使用:。 routes -列出转发路由器的网络和NIDs。可通过配置路由天检查程序局用 Lustre “Ty CASES Hae IS TTR NY TE, EE出现路由大死机，及时重司并恢复故隐路由需的服务。注意建议您使用 IP 地址而不是主机名，以便更轻松地读取调试日志并使用多个接口调试配置。9.2.1. 使用 Lustre 网络标识符 (NIDD) 识别节操Lustre 网络标识符 (NID) 被用来通过和点 ID 和网络类型来识别唯一的 Lustre 网络“SA, NID 的格式为:—network id@network type例如:10.67.73.200@tcp010.67.75.100¢021b—N第一行为TCP/耻 节点，第二行为 InfiniBand 47 Fi.当在各户端上运行 mount 命令时，客户端通过 MDS 的 NID 来检索配置信息。如果该 MDS 具有多个NID，则和客户端应为其本地网络选择适当的 NID。使用 lctl 命令确定在 mount 命令中进行指定的适当的 NID 。请在 MDS 上运行:87\n——————Lustre 文件系统操作手册%ty这aylctl list nids确认客户端是和否能通过给定的 NID 访问该MDS，在客户端上运行:letl which nid",
        "d mdt.testfs-MDT0000.identity upcall很多参数也可通过 lctl conf param进行永久设置。1Lct1l conf param 通常可用于指定任何在文件/Proc/fs/lLIustre可设置的OBD 设备参数。1Lct1conf_param 命令必须在 MGS 节点上运行，并使用以下语法:obd|fsname.cbdtype.property=value)如:mgs# lctl conf param testfs-MDT0000.mdt.identity upcall=NONE$ lctl conf param testfs.llite.max read_ahead_mb=16注意lctl conf_param 命令可在文件系统配置中为指定类型的所有节点设置永久参要获取当前 Lustre 参数设置，请在相应节点上使用LIct1 get param命令，其数名称与1ct1 set_param中使用的相同:Wwlctl get param [-n] obdtype.cobdname.parameter556\n———Lustre 文件系统操作手册ay如:mds# lctl get Param mdt.testfs-+MDT0000.identity upcall使用 lctl list param 命令列出所有可设置的 Lustre 参数:lctl list param [-R] [-F] obdtype.obdname. *oss# lctl list param -RE mdt网络配置选项例如，列出MDT 上的所有参数:说明局动或关闭 LNet; 为其他LIct1l LNet 命令选择网络类型 。打印本地和点上的所有 NID。必须运行 LNet。从远程节点的NID 列表中，标识出将发生接口通信的 NID.network up|down|tcp/elanlist _nidswhich nid nidlistping nidinterface listpeer listconn listactive txroute list设备选择选项 说明通过 LNet ping 检查 LNet fe, KALE打印给定网络类型的网络接口信息。打印给定网络类型的对端节点信息。合指定 NID YZ打印给定网络类型的所有已连接的远端 NID。打印活动传输，仅适用于 Elan 网络。打印完整的路由表。device devname 选择指定的OBD 设备。所有其他命令以此命令所设置的设备为基础。device list 显示本地 Lustre OBD, a/k/a dl.设备操作选项 说明list param [-F",
        "然后是另一个。重复条目、到本地网络的路由条目以及非本地网络上的路由怖的条目将被忽略。在 Lustre 2.5 之前，通过选择更短跳数的路由需来解雇等效条目之间的神突。跳数省略时默认为 1〈远程网络相邻)。至 Lustre 2.5 起，如采优先级相等，则将选择 priority 号更低或跳数更少的路由条目。优先级省略时默认为 0。跳数省略时黑认为 1〈远程网络相邻) 。使用不同本地网络上的路由需来指点同一目标的路由是错误的。如果目标网络字符串不包含扩展部分，则路数默认为1，可以省略〈即远程网络是相邻的) 。事实上，大多数多网络配置都是如此。为给定目标网络指定不一致的跳数是错误的，这也是为什么当目标网络字符串指定来多个网络时需要指定显式路数。43.2.1.5. forwarding (\"\") 该字符串可设置为\" 启用\" 或\"禁用\"，用于明确控制此节点是否应充当路由器的角色，从而在所有本地网络之间转发消息进行通信。使用适当的网络拓扑选项启动 LNet (modprobe ptlrpc) 可启动独立路由器。43.2.1.6. accept (secure) acceptor是一些LND 用于建立通信的 TCP/IP 服务。如果本地网络需要它并且它尚未禁用，则acceptor可用于在单个端口上监听并将连接请求重定向到适当的本地网络。acceptor是 LNet 模块的一部分，可通过以下选项进行配置。| 变量| 说明 1-一|accept (secure) | acceptoz人允许来和目远程节点的连接类型: | | | secure一仅接SOR Yuka TCP 端口 〈1023 以下的端口号) 的|连接; 这是默认值，防止用户罕间进程试图连接到服务硕。|| | all 一接受来自任何 TCP 端口的连接 (注意: 对于|上在用户空间中运行的虚拟机中的客户端来说，必须使用此选 | | 项来允许非特权端口上的连接。| ||none一不运行acceptor。如果 TCP 连接丢失而服务 || | HAF种原因〈如 LDLM 锁回调或大小警)",
        "Credits available for receivingmessages>credits: <Integer. Network Interface credits>SMP: <An array of integers of the form: \"[x,y,...]\", where eachinteger represents the CPT to associate the network interfacewith> seq no: <integer. Optional. User generated, and is85\n1Lustre 文件系统操作手册 译者:这aypassed back in the YAML error block>seq_no 字段和详细信息都没有在输出中显示。routing:- tiny: <Integer. Tiny buffers>small: <Integer. Small buffers>large: <Integer. Large buffers>enable: <0 - disable routing. 1 - enable routingseq no: <Integer. Optional. User generated, and is passed back inthe YAML error block>seq_no 字段没有在输出中显示。statistics:seq no: <Integer. Optional. User generated, and is passed back in theYAML error block>seq_no 字段没有在输出中显示。route:—- net: <network. Ex: tcp or o2ib9.2.gateway: <nid of the gateway in the form <ip>@<net>: Ex:192.168.29.1@tcehop: <an integer between 1 and 255. Optional>detail: <This is only applicable for show commands. 1 - outputdetailed info. 0. basic output>seq no: <integer. Optional. User generated, and is passed back in theYAML error block>seq_no 字段和详细信息都没有在输出中显示。LNet 模块参数概述LNet 内核模块参数指定了如何配置 LNet 以配合 Lustre 运行，具体包括了应配置哪些NICs 和路由等。80\nLustre 文件系统操作手册 译者:As大LNet 的参数一般在 /etc/modprobe.d/lustre.conf 文件中指定",
        "和NID 的字符串。语法如下 (<w>是一个或多个空白字符):<Foutes> :== <route{ ; <route }<route> :=一[<net> [<w><hopcount> ]<w><ni@ [:<priority] {<we<ni@[:<priority] }请注意，Lustre 2.5 中添加了优先级参数。tcp] 上的节点必须经过路由需到达 Elan 网络:options Inet networks=tcpl routes=\"elan 1 192.168.2.2@tcpA\"跳数和优先级用于帮助在多路由配置之间选择最佳路径。以下提供了一种用于撕述目标网络和路由带 NID 的简单但功能强大的扩展语法:<expansiom :== \"({\" <entry { \",\" <entry } \"|\"<entry> :== <numeric range | <nonnumeric iten><numeric range :== <number [ \"-\" <number [ \"/\" <number ] ]550\nLustre 文件系统操作手册 译者: 李和希扩展部分是用方括号括起来的列表，列表中的数字项可以是单个数字、连续的数字范围或跨步数字范围。例如，routes=\"elan 192.168.1.[22-24]@tcp\" 表示i ZfelanO AH sR (hopcount默认为 1) ，且可以通过tcp0网络上的 3 hig at(192.168.1.22@tcp, 192.168.1.23@tcp#192.168.1.24@tcp) 进行访问。routes=\"[tcp,o2ib] 2 [8-14/2]elan\"表示网络tcp0和o2ib0可通过 4个路由器 (8@elan, 10@ elan, 12@elanfill4elan) 进行访问。跳数为 2 意味着这两个网络的流量将经过 2 个路由器，首先是此条目中指定的第一个路由器，然后是另一个。重复条目、到本地网络的路由条目以及非本地网络上的路由怖的条目将被忽略。在 Lustre 2.5 之前，通过选择更短跳数的路由需来解雇等效条目之间的神突。跳数",
        "delete all items described in the YAML file7 lnetctl import --del FILE.yam18 lnetctl import --del < FILE. yaml10 # to show all items described in the YAML file——Inetctl import --show FILE.yaml一NInetctl import --show < FILE.yaml84\nLustre 文件系统操作手册 译者:这ay9.1.12. 导出 YAML 配置文件lnetctl expott命令用于导出配置至 YAML 格式文件。1 lnetctl export FILE.yaml2 Inetctl export > FILE.yaml9.1.13. 显示 LNet 流量数据信息Inetctl 可通过以下命令输出 LNet 流量数据信息 :1 lnetctl stats show9.1.14. YAML 语法Inetctl 实用程序可导入 YAML 文件，并在其中描述的项目上执行以下操作之一:谎加、删除或亚示。网络、路由和路由表的 YAML 块包含相关的统计数据信息，是 YAML 对象，被定义为YAML 序列。每个序列带一个 seq_no 字段。seq_no 字段在错误块中会被返回，以便调用者获悉导致错误的项目。lnetctl 在遇到错误时不会停止处理文件，而是尽了最大努力根据 YAML 文件进行配置。以下讲解了 YAML 语法中通过 DLC 操作的各种配置元素。并非所有的操作 Cas加/删除/显示) 都需要所有 YAML 元素，系统将忽略与请求的操作无关的元素。101213net: <network. Ex: tcp or o21b>interfaces:0: <physical interfacedetail: <This is only applicable for show command. 1 - outputdetailed info. 0 - basic output>tunables:peer timeout: <Integer. Timeout before consider a peer deacd>peer credits: <Integer. Transmit credits for a peer>peer buffer credits: <Integer. Credits available for receivingmessages>credits: <Integer. Network Interface credits>SMP: <An array of integers of the form: \"[x,y,...]\""
    ]
}