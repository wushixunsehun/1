{
    "query": "请具体说明Lustre 的网络堆栈由什么组成？Lustre 支持的网络类型有什么？",
    "summaries": [
        "Lustre 是一个高性能、可扩展的分布式文件系统，支持 POSIX 标准，具备高可用性、数据完整性及多种网络协议。它利用 ZFS 实现存储可靠性，支持 RDMA 等高速网络，提供原子操作和数据校验以确保一致性。Lustre 支持细粒度元数据锁定、多 MDT/OST 扩展、配额管理、文件布局控制及灾难恢复工具。其组件包括 MGS、MDS、MDT 和 OSS，支持 NFS/CIFS 导出，并基于开源 GPL 2.0 许可。",
        "Lustre 文件系统通过条带化技术将数据分布到多个 OST 上，提高性能和存储能力。可用带宽由网络带宽和磁盘带宽的最小值决定，文件系统空间为所有 OST 可用空间之和。条带化允许文件跨多个 OST 存储，提升大文件处理能力。Lustre 网络（LNet）支持多种网络类型，实现高可用性和故障切换，确保系统在故障时快速恢复，减少停机时间。",
        "本文档介绍了Lustre文件系统中网络配置的相关参数和语法。包括路由条目格式、跳数和优先级的作用、扩展语法的使用方法，以及如何配置acceptor服务和socklnd模块。重点说明了路由条目中网络、跳数、优先级的设置，扩展语法用于指定多个节点或范围，同时提到跳数和优先级在路径选择中的重要性。还涉及网络转发、acceptor的配置选项及其作用，以及socklnd模块的使用和负载平衡功能。"
    ],
    "contents": [
        "| 项来允许非特权端口上的连接。| ||none一不运行acceptor。如果 TCP 连接丢失而服务 || | HAF种原因〈如 LDLM 锁回调或大小警) 需要联系客户端，||| 这可能会阻止客户端接收IRS 4% RPC. || accept port (988) | acceptor监听连接请求的端口号。站点配置中需要 ||| acceptor的所有克氮必须使用相同的端口。|| accept packlog(127) |在起连接队列可能的最大长度。| | accept_ timeout (5, W) | 与对等站所通信时多551\nLustre 文件系统操作手册 译者:这ay许acceptor阳塞的最长时间 (LAPD AAR | | accept proto version|输出连接请求应使用的acceptot协议的版本。默认为最新的|上| acceptot协议版本，但也可以设置为以前的版本，以允许节目| 点与只理解该版本的acceptor协议的节点发起连接。acceptor |||可以处理任何一个版本《〈即它可以接受来和目 旧\" 和 新\" PS | | | 点的连接) 。对于当前版本的acceptor协议〈版本 1), WER ||| acceptor只需要一个本地网络，那么它可以与上日的对等点兼容。| HHH 43.2.1.7. rnet_htable sizecnet_htable_size表示内部 LNet 哈希表配置处理的远程网络数，为整数值。rnet_htable_size用于优化哈希表的大小，并不限制您可以拥有的远程网络的数量。未指定此参数时，默认哈希表大小为 128。(在 Lustre 2.3 中引入)43.2.2. SOCKLND 内核 TCP/IP LNDSOCKLND W% TCP/IP LND (sockind) 是基于连接的，使用 acceptor 通过套接字与其对等和氮建立通信。它文持多个实例,在多个接口间使用动态负载平衡。如果ip2nets或网络模块参数未指定接口，则使用所有非环回 IP REO. ZS AN Ht sock indi BAY 28 fh IP fe口的地址决定",
        "李硕“字闻粒度文件和细粒度元数据锁定: 许多客户端可以同时读取和修改相同的文件或目录。Lustre 分布式锁管理种 (LDLM) 确保了文件系统中所有客户端和服务融之间的文件是一致的。其中，MDT 锁管理带负责管理node 权限和路径名锁。个OST 都有其目己的锁管理釉，用于锁定存储在其上的文件条带，其性能与文件系统大小相关。“配额: 用户和组配额可用于 Lustre 文件系统。“容量增长: 通过向群集添加新的 OST 和 MDT，可以不中断地增加 Lustre 文件系统的大小和集群总惠宽。“受控文件布局: 可以在每个文件，每个目录或每个文件系统基础上配置跨 OST 的文件布局。这人允许了在单个文件系统中调整文件 IO 以适应特定的应用程序要求。Lustre 文件系统使用RAID-0 进行条带化并可在 OST 之间调和空间使用大小。。网络数据完整性保护: 从客户端发送到 OSS 的所有数据的校验和可防止数据在传输期间被损坏。”MPII/O: Lustre 架构具有专用的 MPI ADIO 层，优化了并行 VO 以匹配基础文件RRR> NFS 和 CIFS 导出: 可以使用NFS (通过 Linux knfsd 或 Ganesha) 或 CIFS(通过 Samba) 将 Lustre 文件重新导出，使其可以与非 Linux 客户端 〈如Microsoft*Windows 和 *Apple *Mac OS X *) 共享。\"灾难恢复工具: Lustre 文件系统提供在线分布式文件系统检查 〈LFSCK) ，当发生主要文件系统错误的情况下恢复存储组件乙间的一致性。Lustre 文件系统在存在文件系统不一致的情况下也可以运行，而 LFSCK 可以在文件系统正在使用时运行，因此 LFSCK 不需要在文件系统恢复生产之前完成。。 性能监视: Lustre 文件系统提供了多种机制来检查性能和进行调整。。开放源代码: Lustre 软件已获得在 Linux 操作系统上运行的 GPL 2.0 许可证。1.2. Lustre 组件Lustre 软件的安装包括管理服务器 (MGS) 和一个或多个与 Lustre 网络 (LNet)",
        "已获得在 Linux 操作系统上运行的 GPL 2.0 许可证。1.2. Lustre 组件Lustre 软件的安装包括管理服务器 (MGS) 和一个或多个与 Lustre 网络 (LNet) 互连的 Lustre 文件系统。Lustre 文件系统组件的基本配置如下图所示:34\nLustre 文件系统操作手册ayManagement Server (MGS) Management Target MGT}Metadata Server (MDS) Metadata Target (MILT }© Sy Co-located MS and MDS share storageLustre clientsEn Ethermet or InfiniBand Network © ®oss 1©. 8Object Storage Servers(OSSs}图 1: Lustre component1.2.1. 管理服务器 (MGS)MGS 存储集群中所有 Lustre 文件系统的配置信息，并将此信息提供给其他 Lustre组件。每个 Lustre target 通过联系 MGS 提供信息，而 Lustre 客户通过联系 MGS 获取信起Ju OMGS 最好有目己的存储空间，以便可以独立管理。但同时，MGS 可以与 MDS 共址并共享存储空间，如上图中所示。1.2.2 Lustre 文件系统组件每个 Lustre 文件系统由以下组件组成:“元数据服务器 (MDS) - MDS 使存储在一个或多个 MDT 中的元数据可供 Lustre客户器使用。每个 MDS 管理 Lustre 文件系统中的名称和目录，并为一个或多个本地 MDT 提供网络请求处理。“元数据目标 (MDT) - 每个文件系统至少有一个MDT。MDT 在 MDS 的附加存储上存储元数据〈例如文件名，上目录，权限和文件布局)。虽然共享存储目标上的MDT 可用于多个 MDS，但一次只能有一个 MDS 可以访问。如采当前 MDS 发生web, Wl A MDS 可以为MDT 提供服务，并将其提供给客户中。这被称为MDS故障切换。分布式命名空间环境 (DNE) 可文持多个 MDT。除保存文件系统根目录的主 MDT之外，还可以添加其他 MDS “it, fs MDS “aA AY MDT 来保存文件系统的子目录树。35\nLustre 文件系统操作手册 eke",
        "[|File C data [图 5: Lustre cluster at scale最大文件大小不受单个目标大小的限制。在 Lustre 文件系统中，文件可以跨越多个对象 GRA 2000 个) 进行分割，每个对象可使用多达 16 TiB 的ldiskfs ，多达 256PiB 的ZFS。也就是说，ldiskfs 的最大文件大小为31.23 PB, ZFS 的最大文件大小为8EiB。受AMS OST 上可用空间的限制，Lustre 文件系统可文持最多 2°63 字 (SEB) 的文件。尽管一个文件只能被分割成 2000 个以上的对象，但是 Lustre 文件系统可以有数干个OST。访问单个文件的 IO 佛宽是文件中所有对象的总 IO 市宽，即高达 2000 个服务arHli ot. FEAL 2000 多个 OST 的系统上，客户端通过同时执行多个文件读写来完美利用文件系统总第宽。第二章 Lustre 网络 (LNet)2.1. LNet 简介在使用一个或多个 Lustre 文件系统的集群中，Lustre 文件系统的网络通信基础架构通过 Lustre Networking (LNet) 功能实现。LNet 文持许多希用网络类型 CAI InfiniBand #1] IP 网络) ，并允许同时访问路由链接的多种不同网络。当基础网络安装了恰当的 Lustre 网络驱动程序 (LND) 时，可使用远程直接内存访问 (RDMA) 方式。通过高可用性和可恢复性以及故障转移服务硕功能，实现透明恢复。LND 是一种可插拔驱动程序，可为特定网络类型提供文持。例如，ksocklnd 实现了TCP Socket LND，是文持 TCP 网络的驱动程序。LND 被加载到驱动程序堆栈中，每种网络类型对应一个LND。2.2. LNet 的主要功能LNet 的主要功能包括:40这ay\nLustre 文件系统操作手册 译者:这ay。 远程直接内存访问〈当基础网络安装了恰当的 LND)\"文持冰用网络类型”高可用性和可恢复性\"同时文持多种网络类型© 不同网络间的路由LNet 允许各种不同网络互连间的端到端读/写吞吐量达到或接近峰值带宽速率。eit2.3.Lustre 网络Lustre 网络由运行 Lustre 软件的客户端和",
        "然后是另一个。重复条目、到本地网络的路由条目以及非本地网络上的路由怖的条目将被忽略。在 Lustre 2.5 之前，通过选择更短跳数的路由需来解雇等效条目之间的神突。跳数省略时默认为 1〈远程网络相邻)。至 Lustre 2.5 起，如采优先级相等，则将选择 priority 号更低或跳数更少的路由条目。优先级省略时默认为 0。跳数省略时黑认为 1〈远程网络相邻) 。使用不同本地网络上的路由需来指点同一目标的路由是错误的。如果目标网络字符串不包含扩展部分，则路数默认为1，可以省略〈即远程网络是相邻的) 。事实上，大多数多网络配置都是如此。为给定目标网络指定不一致的跳数是错误的，这也是为什么当目标网络字符串指定来多个网络时需要指定显式路数。43.2.1.5. forwarding (\"\") 该字符串可设置为\" 启用\" 或\"禁用\"，用于明确控制此节点是否应充当路由器的角色，从而在所有本地网络之间转发消息进行通信。使用适当的网络拓扑选项启动 LNet (modprobe ptlrpc) 可启动独立路由器。43.2.1.6. accept (secure) acceptor是一些LND 用于建立通信的 TCP/IP 服务。如果本地网络需要它并且它尚未禁用，则acceptor可用于在单个端口上监听并将连接请求重定向到适当的本地网络。acceptor是 LNet 模块的一部分，可通过以下选项进行配置。| 变量| 说明 1-一|accept (secure) | acceptoz人允许来和目远程节点的连接类型: | | | secure一仅接SOR Yuka TCP 端口 〈1023 以下的端口号) 的|连接; 这是默认值，防止用户罕间进程试图连接到服务硕。|| | all 一接受来自任何 TCP 端口的连接 (注意: 对于|上在用户空间中运行的虚拟机中的客户端来说，必须使用此选 | | 项来允许非特权端口上的连接。| ||none一不运行acceptor。如果 TCP 连接丢失而服务 || | HAF种原因〈如 LDLM 锁回调或大小警)",
        "和NID 的字符串。语法如下 (<w>是一个或多个空白字符):<Foutes> :== <route{ ; <route }<route> :=一[<net> [<w><hopcount> ]<w><ni@ [:<priority] {<we<ni@[:<priority] }请注意，Lustre 2.5 中添加了优先级参数。tcp] 上的节点必须经过路由需到达 Elan 网络:options Inet networks=tcpl routes=\"elan 1 192.168.2.2@tcpA\"跳数和优先级用于帮助在多路由配置之间选择最佳路径。以下提供了一种用于撕述目标网络和路由带 NID 的简单但功能强大的扩展语法:<expansiom :== \"({\" <entry { \",\" <entry } \"|\"<entry> :== <numeric range | <nonnumeric iten><numeric range :== <number [ \"-\" <number [ \"/\" <number ] ]550\nLustre 文件系统操作手册 译者: 李和希扩展部分是用方括号括起来的列表，列表中的数字项可以是单个数字、连续的数字范围或跨步数字范围。例如，routes=\"elan 192.168.1.[22-24]@tcp\" 表示i ZfelanO AH sR (hopcount默认为 1) ，且可以通过tcp0网络上的 3 hig at(192.168.1.22@tcp, 192.168.1.23@tcp#192.168.1.24@tcp) 进行访问。routes=\"[tcp,o2ib] 2 [8-14/2]elan\"表示网络tcp0和o2ib0可通过 4个路由器 (8@elan, 10@ elan, 12@elanfill4elan) 进行访问。跳数为 2 意味着这两个网络的流量将经过 2 个路由器，首先是此条目中指定的第一个路由器，然后是另一个。重复条目、到本地网络的路由条目以及非本地网络上的路由怖的条目将被忽略。在 Lustre 2.5 之前，通过选择更短跳数的路由需来解雇等效条目之间的神突。跳数",
        "存储的后备文件系统。这使 Lustre 能够利用 ZFS 的可扩展性和数据完整性特性来实现单个存储目标。“ 符合 POSIX 标准: 完整的POSIX 测试套件以完全相同的方式传递到本地的 ext4文件系统。在集群中，大多数操作都是原子操作，因此客户端永远不会看到损坏的数据或元数据。Lustre 软件文持mmap 0 MPF I/O 操作。.高性能异构网络: Lustre 软件支持各种高性能低延迟的网络，人允许远程直接内存访问 (RDMA) 方式实现在 InfiniBand、IntelOmniPath 等高级网络上的快速高效网络传输。可使用 Lustre 路由桥接多个RDMA 网络以获得最佳性能。Lustre 软件同时也集成了网络诊断。。 高可用性: Lustre 文件系统通过OSTSs (OSS targets) 或者MDT (MDS target) 的共享存储分区实现主动/主动故隐切换。Lustre 文件系统可以与各种高可用性 CHA)管理融一起工作，以实现目动故障切换并消除了单氮故了区 (NSPF) 。这使得应用程序透明恢复成为可能。多重安逆保护 (MMP) 提供了对高可用性系统中的错误的综合保护，和否则将会导致文件系统损坏。可配置多个 MDT 的主动/主动故障切换。这人允许了通过添加 MDT 存储设备和 MDS蔬氮来扩展 Lustre 文件系统的元数据性能。\"安全性: 默认情况下，TCP 连接只人允许授权端口通过。UNIX 组成员身份在 MDS上进行验证。“访问控制列表 (ACL) 及扩展属性: Lustre 安全模型遵循 UNIX 文件系统原则，并使用POSIX ACL 进行增强。请注意一些附加功能，如 root squash.“互操作性: Lustre 文件系统运行在各种 CPU 架构和混合端群集上，并在连续发布的一些主要 Lustre 软件版本乙间具有互操作性。“基于对象的体系结构: 客户端与磁盘文件结构相互隔离，可在不影响客户端的情况下升级存储体系结构。33\nLustre 文件系统操作手册 译者: 李硕“字闻粒度文件和细粒度元数据锁定: 许多客户端可以同时读取和修改相同的文件或目录。Lustre 分布式锁管理种 (LDLM) 确保了文件系统中所有客户端和服务融之间的文件是一致",
        "J. Object K,...)Object Kwritten图 4: Lustre cluster at scaleLustre 文件系统的可用带宽如下:网络带宽等于OSS 到目标的总带宽。dena OSE Tet Atty (OST) 的磁玛市宽总和，受网络带宽限制。@CIk总带宽等于磁盘带宽和网络带宽的最小值。”可用的文件系统空间等于所有 OST 的可用空间总和。1.3.1. Lustre 文件系统条带化Lustre 文件系统高性能的主要原因之一是能够以循环方式跨多个 OST 将数据条素化。用户可根据需要为每个文件配置条市数量，条市大小和 OST。当单个文件的总市宽超过蛙个 OST 的从宽时，可以使用条市化来提高性能。同时，当单个 OST 没有足够的可用空间来容纳整个文件时，条市化也能发挥它的作用。如图下图所示，条齐化允许将文件中的数据段或\" 块\" 存储在不同的OST 中。在Lustre 文件系统中，通过RAID 0 模式将数据在一定数量的对象上进行条市化。一个文件中处理的对象数称为 stripe_count。每个对象包含文件中的一个数据块，当写入特定对象的数据块超过 stripe_size HY,文件中的下一个数据块将存储在下一个对象上。stripe_count 和 stripe_size 的黑认值由为文件系统设置的，其中，stripe_count 为 1 ，stripe_size 为 1MB。用户可以在每个目录或每个文件上更改这些信。下图中, 文件 C 的 stripe_size 大于文件 A 的 stripe_ size，表明更多的数据被允许存储在文件 C 的单个条帝中。文件A 的 stripe_count 为3，则数据在三个对过上条带化。文件B 和文件 C 的 stripe_count 是 1。OST 上没有为未写入的数据预留空间。39\nFile A data [|File B data [|File C data [图 5: Lustre cluster at scale最大文件大小不受单个目标大小的限制。在 Lustre 文件系统中，文件可以跨越多个对象 GRA 2000 个",
        "多种网络类型© 不同网络间的路由LNet 允许各种不同网络互连间的端到端读/写吞吐量达到或接近峰值带宽速率。eit2.3.Lustre 网络Lustre 网络由运行 Lustre 软件的客户端和服务器组成。它不局限于一个 LNet 子网，只要网络之间可以进行路由，它可以跨越多个网络。类似地，一个单独的网络可以包含多个 LNet 子网。Lustre 网络推栈由两层组成: LNet 代码模块和 LND。LNet 层在 LND 层之上操作，其方式类似于网络层在数据链路层之上操作。LNet 层是无连接的、异步的，不进行传输数据验证。LND 层是面问和连接，通痢进行数据传输验证。LNets 通过唯一的标签进行标识，该标签为对应的 LND 和一个数字组成的字符串，如 tcp0、o2ib0、o2ib1。LNet 上的每个和点至少有一个网络标识符 (NID) ，由网络接口地址和 LNet 标签组成，形式为: *address*@*LNet label*.例如:1 192.168.1.2@tcp0d2 10.13.24.908o2ib1在革些情况下，Lustre 文件系统流量可能需要在多个 LNets 之间传递，这就需要用到 LNet 路由。请注意，LNet 路由不同于网络路由。2.4. 支持的网络类型LNet 代码模块所包含的 LNDs 支持以下网络类型 :。 InfiniBand: OpenFabrics OFED (02ib)° TCP (包括 GigE, 10GigE, IPoIB 等在内的所有 TCP 流量的网络)¢ RapidArray: ra* Quadrics: Elan4]\nLustre 文件系统操作手册这ay第三章 Lustre 文件系统的故障切换3.1. 什么是故障切换在高可用的 CHA) 系统中，通过使用元余硬软件，并利用故障时可目动恢复的软件，来最大限度地减少计划外停机时间。当出现服务需或存储设备丢失、网络或软件故隐时，系统服务将在最小的中断时间后继续运行。通希，可用性通过系统处在可工作状态的时间比例来衡量。可用性通过硬件和 或) 软件的副本来实现。这样，当主服务需发生故障或不可用时，备用服务需将进行切换，以运行应用和相关资源。该故障切换的过程在"
    ]
}