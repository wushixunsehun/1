{
    "query": "当用户因多次输错密码被锁定时，值班员应如何解锁？",
    "summaries": [
        "当服务处理请求但回复丢失时，客户端需重发请求。VBR功能通过比较对象的版本号判断请求是否可安全重放，提高系统可靠性。锁恢复过程中，客户端重传锁信息，MDS信任客户端提供的锁状态。请求重发后，MDS需重建回复，确保操作不重复。VBR通过跟踪inode版本，使更多客户端能重新集成，避免数据丢失。",
        "密码策略包括有效期、最大失败次数、最小年龄、长度限制及强制修改等。密码强度通过配置文件定义，包含字符种类、大小写、数字、符号等要求。用户首次登录或重置密码后需强制修改，可通过-f选项启用。用户被锁定后可自动或管理员解锁。密码策略由配置文件定义，支持修改与查询。添加新用户时需关联Slurm，并可迁移家目录至指定MDT以均衡存储。",
        "新会话972846由用户root启动。常见报错包括内存不足、段错误、总线错误和Lustre错误，处理方式各有不同。用户多次输错密码会导致锁定，监控系统会报警，需值班员根据情况解锁。故障节点可drain处理，通过平台修改节点状态。运维操作包括用户解锁、节点管理、资源查询等。"
    ],
    "contents": [
        "5分钟，经过管理员审核用户为非恶意破解密码时，可以通过以下命令手动解锁用户。\n# yhpasswd -u login\n7.修改密码策略\n用户密码策略由/etc/lam-yhpc/addPolicy.ldif文件进行定义。\n如果需要修改密码策略，直接修改上述文件，然后执行命令：\n# yhpolicy -u\n查询当前密码策略，执行命令\n# yhpolicy -l\ndn:cn=default,ou=pwpolicies,dc=yhpc\ncn: default\nobjectClass: pwdPolicy\npwdPolicyChecker\nperson\ntop\npwdAttribute: userPassword\npwdMinAge: 0\npwdMaxAge: 7776000\npwdMinLength: 12\npwdExpireWarning: 604800\npwdCheckModule: check_password.so\npwdCheckQuality: 3\npwdMustChange: TRUE\npwdAllowUserChange: TRUE\npwdSafeModify: TRUE\nsn: yhpc\npwdGraceAuthNLimit: 6\npwdInHistory: 2\n8. 添加新用户\nyhuseradd -h\nUsage: yhuseradd [options] LOGIN\nOptions:\n-c COMMENT    set the GECOS field for the new user account\n-d HOME_DIR   home directory for the new user account\n-g GROUP      force use GROUP for the new user account\n-G GROUPS     list of supplementary groups for the new\nuser account\n-h            display this help message and exit\n-p PASSWORD   set password for the new user account\n-s SHELL      the login shell for the new user account\n-u UID        force use the UID for the new user account\n-f            force Reset passwd in the first time\n添加新用户时，如果该用户需要采用slurm提交作业，就进行slurm与用户关联：\n# yhacctmgr add user <login> account=test wckey=test\n文件系统如果采用多个MDT构成的",
        ": New session 972846 of user root.\n\nFeb 9 16:00:04 cn1392 systema: Started Session 972846 of user root.\n常见的报错信息如下：\n报错信息 | 处理方式\nOut of memory | 节点数不变，减少作业规模，降低内存使用\n增加核数，减少每个节点的内存使用\n段错误 | 1）重提试试；2）检查程序报错位置的代码。\nBus error | 原因比较复杂，更换节点提交试试。\nLustre error | 可能是存储故障导致。\n4.6 用户输错密码过多\nth-hpc3-In0\n\nshixp登录错误8次\n\nTH-HPC\n\n其他\n\n安全\n如上图，用户输错密码过多后，监控会报警，报警信息包括集群、登录节点、用户名。\n错误次数不超过20持续观察，错误次数过多时值班员参考下面的流程进行处理：\n如果确认用户操作失误导致被锁，需要给用户解锁，按下面的流程操作：\n（1）连接相应集群，点击“用户操作”-“用户登录解锁”。\n统一监控运维平台 EAE\n\nwien\n\nvs\n览\n\n剧本编排\n\n剧本执行\n\n执行审计\n\n定制大屏Bias 运维总点\n\n其他操作 节点操作\n\nTH-HPC4\n日 ep TH-HPC\nOD 存储分区操作\nO 资涯党作\nO 用户操作\n© 作灿操作\n© 服务操作\n\n故障查询\n\nTH-HPC\n\n全 TH-HPC\n\n修改用户组配额\n\n修改用户配额\n\n查询账户资源\n\n查询用户组配额\n（2）在弹出的对话框中输入节点名和用户名，点击确定。\n您确定要执行用户登录解锁操作吗?\n\n* 节点名 th-hpct-Ind\n\n+用户各| sunbl\n4.7 drain计算节点\n值班过程中遇到故障节点或疑似故障节点，可以暂时drain起来，留给硬件维护人员处理。\n连接相应的平台，点击“资源操作”-“修改节点状态”：\n定制大屏运维总览故障查询\n\nTH-HPC\n其他操作 节点操作\n\n TH-HPC4PD TH-HPC\n日 ee TH-HPC\n©",
        "文件的内容，回复数据包含了可用于标识客户端的版本号。38.4. 基于版本的恢复可使用基于版本的恢复 (VBR) 功能来处理在恢复期间无法重放的客户端请求(RPC) ，从而提高 Lustre 文件系统的可靠性。在无 VBR 功能的之前的 Lustre 版本中，如果 MGS 或 OST 发生故障将触发恢复操作，客户端会尝试重放其请求。客户端只允许按顺序重放RPC。如果特定客户端无法重播其请求，那么这些请求以及后续序列中的客户奖请求都将丢失。由于必须等待更早的RPC 完成, \"下游\" 客户端将永远不会重放它们的请求。最终，恢复期将超时《因此组件可以接受新请求) ，导致一些客户被驱逐，其请求和数据丢失。使用VBR 后，恢复机制不会导致客户端或其数据丢失，这是因为对 inode 版本的更改进行了跟踪，更多客户端能够重新集成到集群中。使用VBR 进行 node 跟踪:。 每个 inode 存储一个版本喜，即 inode 更改的最后事务编号 〈transno ) 。。当要更改 inode 时，inode 的操作前版本号将被保存在客户端的数据中。\"客户端保留操作前 inode 版本吕和操作后版本号 〈事务编号) ，并在服务人逢发生故障后发送它们。。 如采操作前后版本匹配，则重放请求。在请求中修改的所有 inode 上分配操作后的ASS注意因为操作中可能涉及多个 inode, RPC 最多可包含四个预操作版本。进行\" 重命名\"操作时，可以修改四个不同的 inode。在正铺操作期间，服务硕:。更新给定操作中涉及的所有 inode 的版本。。 将旧的和新的 inode 版本返回给客户端。当恢复正在进行时，VBR 遵循以下步骤:1. 只有当受影响的 inode 有与原始执行事务时版本相同时，VBR A SUV EPP sina HE HB事务〈即使因客户端丢失导致事务序列存在间陀)。2. 服务豆笠试执行和客户端发起的每个事务〈即使重新集成失败)。六-一468\n—Lustre 文件系统操作手册 译者:DCZR At3",
        "下，唯一的可能是服务融处理了一些请求但是回复丢失了。客户站必须在其重发列表中包含这些请求，以便恢复宛成后进行重发。如有果所有客户端都未重新连接，则故隐客户端可能有不会再被重放的请求。VBR功能可用于确定间队之后的请求是否可以被安全地重放。文件系统中的每个条目〈《MDSinode 或 OST 对象) 将在磁奏上存储被修改的最后事务编号。来目服务郁的每个回复都含它所作用的对象先前的版本号。在 VBR 重放期间，服务器将重新发送请求中的先前版本号与当前版本号进行匹配。如果版本匹配，则请求将作用于对象，且可以安全地进行重放。有关更多信息，请参见本章第 4 节\" 基于版本的恢复\"。38.2.8. 锁恢复如果所有请求都成功重放且所有客户端都重新连接，客户端会进行锁重放。人每个客户端都会发送它从此服务器获取的每个锁的信息以及其状态 〈无论何时被授予、什么模式、什么属性等) ，随后恢复成功完成。目前，Lustre 软件不进行锁验证，而是信任客户端呈现准确的锁状态。这不会带来任何安全问题，因为 Lustre 软件版本 Lx 客户端的其他信息〈如用户 ID) 在正常操作期间也是可信任的。在重放了所有已保存的请求和锁之后，客户端发送一个MDS_GETSTATUS请求并设置1ast-replay标志。在所有客户端都完成重放 (发送带有相同标记的 getstatus 请求)前，该请求的回复将被阻止，以便客户端在恢复完成之前不发送非恢复请求。466\nLustre 文件系统操作手册 译者:As大38.2.9. 请求重发且服务锅上恢复了所有先前共享的状态〈目标文件系统更新至客户器缓存，且服务需已重建客户问持有的锁) ，客户端就可以重新发送任何之前没有得到答复的请求。该处理与正常请求的处理类似，在一些情况下，服务俘可以进行重新生成回复。38.3. 重建回复当回复丢失时，MDS 需要能够在原始请求被重新发送时重建回复。在保持锁定系统的完整性的同时，必须在不重复任何非需等操作的情况下完成此操作。MDS",
        ": 密码有效期，到期需要强制修改密码，单位是秒\n- pwdMaxFailure: 密码最大失效次数，超过后账号被锁定\n- pwdMinAge: 密码有效期，正整数值表示2次修改密码的时间，避免反复修改密码，0表示不限制\n- pwdMinLength: 用户修改密码时最短的密码长度\n- pwdMustChange: 用户登录系统后提示修改密码，设置为TRUE或FALSE\n- pwdSafeModify: 是否允许用户修改密码，与pwdMustChange共同使用\n密码强度：\n密码强度配置文件：/etc/lam-yhpc/check_password.conf\n# cat check_password.conf\nmin_points 2\nuse_cracklib 1\nmin_upper 2\nmin_lower 2\nmin_digit 2\nmin_punct  0\nmax_consecutive_per_class 0\n密码强度属性解析：\n- min_points: 表示输入密码字符的种类数\n- use_cracklib 1表示使用字典，0表示不使用字典\n- min_upper：表示大写字母最小位数\n- min_lower：表示小写字母最小位数\n- min_digit：表示数字最小位数\n- min_punct：表示符号最小位数\n- max_consecutive_per_class：表示每类字符最大连续位数\n5. 用户首次登录系统强制修改用户密码\n当用户首次登录系统和重置密码后，强制用户修改密码。如果要启用该功能，在添加新用户（yhuseradd）和重置用户密码(yhpasswd)时,使用-f选项，如：\n# yhuseradd -f zqh\n# yhpasswd -f zqh\n6. 用户解锁\n当用户连续输入错误密码次数超过密码策略规定值后，系统将锁定用户。被锁定的用户需要解锁才能登录系统，解锁方式有2种。\n6.1 自动解锁\n当pwdFailureCountInterval密码验证失败后恢复时间设置比较短时，默认5分钟，当恢复时间达到时会自动解锁\n6.2 管理员解锁\n当pwdFailureCountInterval密码验证失败后恢复时间设置比较长时，默认5分钟，经过管理员审核用户为非恶意破解密码时，可以通过以下命令手动解锁用户。\n# yhpasswd -u login\n7.修改密码策略\n用户密码策略由/etc/lam-yhpc/addPolicy",
        "。38.3. 重建回复当回复丢失时，MDS 需要能够在原始请求被重新发送时重建回复。在保持锁定系统的完整性的同时，必须在不重复任何非需等操作的情况下完成此操作。MDS 故隐切换时，用于重建回复的信息必须在与磁盘上进行组合或价套事务的序列化。38.3.1. 所需状态对于大多数请求来说，服务句在last_zcvdq文件中存储三种数据就足够了:。 请求的 XID。产生的事务编号〈如果有的话)。 结果代码 (eq->rq_status)对于\" 打开请求\"来说，请求的处置信息也必须保存。38.3.2. BE\" 打开请求\" 的回复\"打开请求\" 的回复最多包含三条信息《除了\"请求日志\" 的内容):。 文件句柄© Bayt*mds_ body 以及所创建文件的相关信息 (O_CREAT)处置、状态和请求数据〈由客户端重刹发送的完整数据) 足以确定所授予的是哪种类型的锁和句柄、是否创建了打开文件句柄，以及应在ndqs_bodqy中描述的资源。38.3.2.1. 查找文件句柄”文件句柄可以在请求的XID 和每个导出的打开文件句柄列表中找到。38.3.2.2. 查找资源/FID ”文件句柄包含资源/FID。38.3.2.3. 查找锁句柄“可以通过遍历相应远程文件句柄 〈显示在重发的请求中) 下资源所授予的锁列表来查找锁句柄。验证锁的模式是否正确 (通过执行上面的处置/请求/状态分析来确定) ，以及是和否被授予至适当的客户端。467\nLustre 文件系统操作手册 译者:As大38.3.3. 客户端上的多个回复数据从 Lustre 2.8 起，MDS 可为每个客户端保存多个回复数据。回复数据存储在 MDT的内部文件rceply_dqata中。除了请求的XID、事务编号、结果代码和打开请求的处置信息外，得益于1ast_rcvq文件的内容，回复数据包含了可用于标识客户端的版本号。38.4. 基于版本的恢复可使用基于版本的恢复 (VBR) 功能来处理在恢复期间无法重放的客户端请求(RPC) ，从而",
        "添加新用户时，如果该用户需要采用slurm提交作业，就进行slurm与用户关联：\n# yhacctmgr add user <login> account=test wckey=test\n文件系统如果采用多个MDT构成的lustre文件系统，为避免用户的文件元数据全部存放在mdt0上，可以将用户分散在不同mdt上。在用户首次登录后，会在文件系统中生成其家目录，将家目录迁移到指定mdt上,命令如下：\n# lfs migrate [mdt-count|-c] <mdt_count>  [mdt-hash|-H] <hash_type>   [mdt-index|-m] <start_mdt_index>\n[verbose|-v]      <directory>\nmdt:    MDTs to stripe over, if only one MDT is specified, it's the MDT index of first stripe\nmdt_count: number of MDTs to stripe a directory over\nmdt_hash:  hash type of the striped directory. mdt types:\nall_char  (type 1)sum of characters % MDT_COUNT\nfnv_1a_64 (type 2)FNV-1a hash algorithm (default)\ncrush     (type 3)CRUSH hash algorithm"
    ]
}