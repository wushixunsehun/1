{
    "query": "一线值班员在发现存储问题时，应如何执行处理流程？",
    "summaries": [
        "文本主要描述了存储系统中硬盘故障及处理过程。某硬盘在11小时24分钟内恢复了2.62T数据，操作成功。同时，发现一个卷降级，需检查zpool状态并更换坏盘。部分硬盘出现错误，如“Medium Error”和“Unrecovered read error”，需替换故障设备。若同时坏盘两块及以上，需联系二线处理。此外，ION节点出现连接问题，需检查是否正常或重启，多台ION报警可能涉及网络或供电问题，需挂起作业并联系支持团队。",
        "本文档主要介绍了存储系统相关操作命令及故障处理方法。包括对存储、ION、LN等设备的重启、开关机、状态查看等操作，以及通过cfs_stat和yhpe命令查看连接数和网络状态。在故障处理部分，详细描述了存储节点的对应关系，针对JBOD扩展卡、风扇、电源、磁盘状态异常等情况提供了检查和处理步骤，如检查故障灯、重新插拔盘柜、查看zpool状态、收集日志、查询硬盘设备名等操作流程。",
        "文本主要描述了HPC系统中存储节点（OST）的运维操作和故障处理流程。包括剧本执行、节点操作、存储分区管理、链接数查询、服务状态监控、数据拷贝、应急操作等。当出现OST掉线或RAID卡超时故障时，需检查网络、电源，并在特定时间段内重启节点。同时，需关注卷的挂载状态和恢复时间，确保系统正常运行。运维人员需通过统一监控平台进行操作，并在必要时通知相关人员。"
    ],
    "contents": [
        "S54 OFFLINE999\nJBOD19-S55 ONLINE999\n查询结果应该类似上边的截图。可以看到JBOD19-S54已经OFFLINE了。\n2）收集日志\n注：此步骤可能需要5分钟，待此步骤结束再进行下边的操作。\n操作确认\n确定要执行 收集日志 操\n最后会有一个压缩文件：\n“device: /dev/sdz\",\n\nFile saved: /tmp/wddcs_oss18_20240311_110548/disks/smartctl_-x_sdz.txt”,\nFile saved: /tmp/wddcs_oss18_20240311_110548/disks/sg_logs_-pex18_sdz.txt”\n“File saved: /tmp/wddcs_oss18_20240311_110548/disks/sdparm_-i_sdz.txt”,\n“File saved: /tmp/wddcs_oss18_20240311_110548/disks/sg_ing_sdz.txt”,\n“File saved: /tmp/wddcs_oss18_20240311_110548/disks/sg_ing_-p@x8@_sdz.txt”,\n“File saved: /tmp/wddcs_oss18_20240311_110548/disks/sg_ing_-p@x83_sdz.txt”,\n\nPLAY [mna1] {tt tcdocnenn ia anooocncinninoooonencinmnnonooncicininooonnee eri\n\nskipping: no hosts matched\n\nPINE eC eeeeeeteeneeeeeetenteesreatettensrcntentrnsrratrntrnsrsetrntresrras©d\n\n89.72.103.18: okr=:unreachable-@ 。 failed-\n\nchanged-:\n\nskipped-\n\nrescued=0\n3）查询硬盘设备名\n硬盘 | JBOD19-S54|\n口 开始执行\n\n口_“命令输出:\n\n© PLAY [al1] xzrrrrrrrsrrrrrrrrrsrrrrrrrrrrrrrrrrerrrrrrrrerrrerrrrrerrrrrrrrrerr\n\n© changed: [89.72.103.18]\n\nok: [89.72.103.18] => {\n\nPLAY. RECAP S00; aso Oo ESOS EEE BO BEBO ERE IOOCBEOO UE GO RESO CEE IOC ESOC GEO IOE\n\n89.72.103.18: ok=2changed=1 。 unreachable=-8failed=@ 。 skipped-8 。 rescued-8 —ignored-0\n\n口 “执行结果:成功\n通过查询得到硬盘符为sdbm。\n4）标记",
        "号 应急操作: THL6-OST@0@4: 497 ”running(healthy)THL6-0sTeee5: 497 running(healthy)\n口 批量操作: THL6-0sT6666: 497 ”running(healthy)THL6-0sT6687: 497 ”running(healthy)\n-\"ost12: THL6-OST0008: 497 ”running(healthy)THL6-0ST@@09: 497 running(healthy)\n吕 其他操作\"ost13: THL6-0ST896a: 497 ”running(healthy)THL6-0sTeeeb: 497 ”running(healthy)\nTH-eX\"ost14: THL6-0SsT86ec: 497 ”running(healthy)THL6-OSTeeed: 497 running(healthy)\nTH-3F\"ost15: THL6-OSTe@ee: 497 ”running(healthy)THL6-0sTeeef: 497 running(healthy)\n\"ost16: THL6-0ST010: 497 ”running(healthy)THL6-osTeel1: 497 ”running(healthy)\n\nTH-3M\n\n\"ost17: THL6-0ST6912: _497iTHL6-OST@Q13: _497\n恢复作业，并在微信群通知。\n统一监控运维平台= 运维管理\n\n定制大屏剧本执行\n\n节点操作\n\nTH-HPC4\n日 © 存储分区操作\n加 THL5\n加THL7\n加 THL8\n\n执行审计\n\nTH-HPC\n\n全 TH-HPc > THL6\n\nAr\n\n分区作业挂起\n注意：\nHPC的每个ost上有两个卷，命令输出的含义为，如：\n‘ost20: THL6-0ST6618: 497 running(healthy)THL6-0ST8619: 497running(healthy)\n\npm 卷名链接数状态卷名链接数状态\n在运维平台查看链接恢复情况需要注意两点：\n1．挂载卷数是否正常。\n例如：ost20应该有2个卷，出现如下输出则意味着少了一个卷：\nost20: THL6-OST0018:497RECOVERING:271\n遇到少卷的情况，需要重启。\n2. 恢复时间是否正常。\n例如执行“cfs_stat -o ost20”出现如下信息：\nost20: THL6-OST0018:497RECOVERING:271THL6-OST0019:497RECOVERING:27777\n每个卷后面字段“RECOVERING:",
        ".， OSTHRBBEP...计算节点部署客户端.， 远程在线用户\n剧本执行四THL6\n二emsiveenee wm—\n© 资源操作\n\n0 用户操作\n\n© 作业操作mds1:查询日志 久\n\n© 服务操作\n\nO 数据拷贝Oo FeiMT\n\n号 应急操作|\n\n口#RFy””命令输出:\n\n名。 PLAY [al ])] 280 eb sb sb ep ap aOR OSE SO III ORI II A Ta a a a a\n= 运维管理 / 剧本执行\n\n定制大屏剧本执行\n\n统一监控运维平台\n\n其他操作 节点操作\n\nTH-HPC4\n\n器 ce TH-HPC\n剧本编排。号 存储分区操作\n中 资质时作\n剧本执行号 用户操作\n3 (ASE\n号 服务操作\n号 数据拷贝\n号 应急操作\n号 批旺操作\n号 其他操作\n\n计算节\n\n查和多传感器日志远程协助电源管理\n等待重启完成，查询分区链接数，确认mds的链接数已经恢复。\nTH-HPC\n节点操作\n\n TH-HPCA© TH-HPC > THL6\n\n8 ofa]y\n\n日 © 存储分区操作\n\n加 THL5\n\n分区作业恢复分区作业挂起\n\n剧本执行\n\n加THL7\n\nca?THs\n\nTHL6查询链接数 X\n\n局 用户操作© ok: [121.16.225.1] => {正常的链接数状态 vi\n\n© 作业操作\n: THL6-MDTeeee: 561 ， running(healthy)加\n口 服务操作:::-\n: THL6-0sTeeee: 497 ”running(healthy)THL6-0sTeee1: 497 ”running(healthy)\nO 数据拷贝: THL6-OST@@02: 497 running(healthy)THL6-0sT6663: 497 ”running(healthy)\n号 应急操作: THL6-OST@0@4: 497 ”running(healthy)THL6-0sTeee5: 497 running(healthy)\n口 批量操作: THL6-0sT6666: 497 ”running",
        "23:11:25\n\n2024]\n2024]\n2024]\n2024]\n2024]\n2024]\n\nsd 15:0:49:0: [sddf] tag#5196 FAILED Result: hostbyte=DID_OK driverbyt\nsd 15:0:49:0: [sddf] tag#5196 Sense Key : Medium Error [current] [desc\nsd 15:0[sddf] tag#5196 Add. Sense: Unrecovered read error”,\n\nsd 15:0:49:0: [sddf] tag#5196 CDB: Read(16) 88 00 00 00 00 65 69 94 49\nblk_update_request: critical medium error, dev sddf, sector 2324616254\n\nZio} pool=ost34-4 vdev=/dev/disk/by-vdev/JBOD34-$39-part1 error=61 type\noss35查询zpool池列表 X oss35查询日志 X oss35查询zpoo|池状态 < oss35:收集日志 X\n\n\"Ntsufficient replicas exist for the pool to continue functioning in a\",\n\"\\tdegraded state.\",\n\n“action: Replace the faulted device, or use ‘zpool clear’ to mark the device\",\n“\\trepaired.\",\n\nont is\n\n\\tNAMESTATEREAD WRITE CKSUM\",\n\"\\tost34-4DEGRADED998 ，\n\"\\t raidz2-9DEGRADED998 ，\n\"\\tJBOD34-$36 ONLINE998 ，\n\"\\tJBOD34-$37 ONLINE998 ，\n\"\\t 3]B0D34-S38 ONLINE@98\"，\n\n“\"\\tJBOD34-S39 FAULTED829@ too many errors\",\n\n“\\t\n\n\"\\tJBOD34-S41 ONLINE89\n\n\"At 3]B0D34-S42 ONLINE日98\n\"At 3]B0D34-S43 ONLINE日98\n\"At 3]B0D34-S44 ONLINE日98\n\"At 3]B0D34-S45 ONLINE日98\n\n“errors: No known data errors”",
        "3]B0D34-S43 ONLINE日98\n\"At 3]B0D34-S44 ONLINE日98\n\"At 3]B0D34-S45 ONLINE日98\n\n“errors: No known data errors”\n如果同时坏盘2块及以上，联系二线处理。\n5.1.4 获取smart值出现异常\n参考5.1.2更换硬盘。\n5.1.5 ION失去连接\n1）某一个ION报警，查看ION是否正常，不正常则重启ION。\n节点状态连接成功，并且查询负载有输出，则ION正常。\n定制大屏aia故障详情运维总览\n\nTH-HPC TH-3F\n\n其他操作 节点操作\n\nion0Q\neq 节点编号: ion0\nG@ © TH-3F\n序号: 4510所属集群: TH-3F硬盘大小: 无硬盘\n日 VO-00\n日 ion节点名称:ion0所属分区:_null硬盘类型: 无硬盘\n剧本执行Diono\n\n节点类型:存储位置: 1903机房-TH-3F-VO-00-39.0\n\n查询日志查询内存清除进程cpu进程排序mem进程排序\nTHeX = TH-3F\n\n其他操作 节点操作一\n\n总览TH-HPC4DPTH-3F\n\n:TH-HPC\n\n剧本编排>TH-eX\n\n1903网络报警ION RABE...SRT RESP in.MDS RBBSP...OST RABEEP...\nRIMSDBRS ME\nO 资源操作\n\n0 用户操作\n\nOf 作业操作\n\n© 服务操作\n\nO 数据拷贝\n\n局 应急操作\n\n=)\n\n查记ipmi日志AAS\n您确定要执行电源管理操作吗?\n\n+ 节点名 。 ion10\n\n+动作 | 重启\n2）多台ion报警\n可能的原因：高速网板卡、IB板卡、机柜供电制冷等问题。\n处理办法：挂起对应集群的作业，联系二线和科大值班人员。\n3）ion重启后报警未消失\n1.确认系统状态，是否可以ping通，是否可以ssh进去。\n2．若没有系统，或开机卡住，观察ib网卡（插一根绿线的）是否有绿灯闪烁或常量。若不亮，更换ib网卡。\n3.若进系统正常，参考5.2.2，处理",
        "将盘柜重新插拔。\n5.1.2 磁盘状态异常\noss18ost19-5JBOD19-S54磁盘状态异常\n\noss18ost19-5状态异常\n以ost19-5 JOBD19-S54举例\n换盘操作顺序如下：\n其他操作\n\noss18\n\n节点编号: oss18\n\n日 ee TH-3F\n序号: 4468所属集群: TH-3F\n日 Vo-33\n日 storage节点名称: oss18所属分区:_null\n加oss18节点类型: 存储节点存储位置: 1903机房-TH-3F-VO-33-8.0\n\n查询日志查询内存\n\nmem进程排序\n\n==]\n\n查询负载\n\n硬盘大小: 无硬盘\na: 无硬盘\n\n节点状态: | 连接成功\n\n清除进程cpu进程排序\n\n查询zpool池列…5S 下线硕盘\n1）查看zpool状态\n连接对应oss，通过报警内容，查看zpool状态\nost19-引\npool: ost19-5\nstate: DEGRADED\nstatus: One or more devices has been taken offline by the administrator.\nSufficient replicas exist for the pool to continue functioning in a\ndegraded state.\naction: Online the device using 'zpool online' or replace the device with\n\"Zpool replace’.\nscan: scrub in progress since Sun Mar 10 22:55:26 2024\n3.82T scanned at 17.2G/s, 1.50M issued at 6.77K/s, 27.0T total\n0B repaired, 0.00% done, no estimated completion time\n\nconfig:\n\nNAMESTATEREAD WRITE CKSUM\nost19-5DEGRADED999\nraidz2-0DEGRADED999\nJBOD19-S46 ONLINE999\nJBOD19-S47 ONLINE999\nJBOD19-S48 ONLINE999\nJBOD19-S49 ONLINE999\nJBOD19-S50 ONLINE999\nJBOD19-S51 ONLINE999\nJB0D19-S52 ONLINE999\nJB0D19-S53 ONLINE999\nJBOD19-S54 OFFLINE999\nJBOD19-S55 ONLINE999\n查询结果应该类似上边的截图。可以看到JBOD19-S54已经OFFLINE了。\n2）收集日志\n注：此步骤可能需要5分钟，待此步骤结束再进行下边的操作",
        "ONLINE\n3B0D19-S54] ONLINE\n3B0D19-S55] ONLINE\n\neeecesceecee000\nooooooooeooa\noaeoaoaeoeaeoeaeaoae\n\n“errors: No known data errors”\n\nPLAY. RECAP S00; aso Oo ESOS EEE BO BEBO ERE IOOCBEOO UE GO RESO CEE IOC ESOC GEO IOE\n\n89.72.103.18: ok=2changed=1 。 unreachable=-8failed=@ 。 skipped-8 。 rescued-8 —ignored-0\n代表盘在11小时24分钟内恢复了2.62T，恢复完毕。可以关闭硬盘灯。\n您确定要执行标记硬盘操作吗\n\n硬盘 JBOD19-S54\n\n动作 | 关闭\n脚本执行成功，其中Ident=0，表示硬盘已取消点亮。\n5.1.3 xx卷降级\n集群故障点故障原因故障级别发生时间\n\nTH-eXoss35thfs2-0ST005d卷降级e 严重2024-07-13T23:13:09\n通过查询zpool状态检查是否坏盘，如若异常，参考5.1.2更换硬盘。\nTH-eX\nBF 节点操作\n\noss35Q\noof 节点编号: oss35\nEl co TH-eX\n日 yo-37Geen所属集群 TH-eX硬盘大小 BR\n日 storage节点名称: oss35所属分区:_null硬盘类型: 无硬盘\nD oss35节点类型: 存储节点存储位置: 1903机房-TH-eX-VO-37-节点状态:| 连续成功 |\n6.0\n\n清除硬盘设备名查询内存清除用户进程标记硬盘cpu进程排序\nmem进程排序查询硬盘设备名查询负载收集日志查询zpool池列…下线硬盘\n\"[sat\n“[sat\n“[sat\n“[sat\n“[sat\n“[sat\n\nJul 13\nJul 13\nJul 13\nJul 13\nJul 13\nJul 13\n\n23:11:25\n23:11:25\n23:11:25\n23:11:25\n23:11:25\n23:11:25\n\n2024]\n2024]\n2024]\n2024]\n2024]\n2024]\n\nsd 15:0:49:0: [sddf] tag#5196 FAILED Result:",
        ". 恢复时间是否正常。\n例如执行“cfs_stat -o ost20”出现如下信息：\nost20: THL6-OST0018:497RECOVERING:271THL6-OST0019:497RECOVERING:27777\n每个卷后面字段“RECOVERING:xxx”表示“恢复的时间为xxx秒”，正常一个卷的恢复时间在600s以下。上面信息中THL6-OST0019卷恢复时间为27777秒，明显不正常，等待两分钟后仍然不正常时，需要将这个ost重启。\n3.3.2 多个ost掉链接\n1）可能是网络问题，联系二线值班人员协助处理。\n2）可能是机柜掉电，联系二线值班人员和运维部值班人员协助处理。\n3.3.3 ost报raid卡timeout故障\nost74raid1出现timeout故障TH-HPC存储节点硬件。 警告\n\nost74raid2出现timeout故障TH-HPC存储节点硬件\n1）raid卡出现timeout故障不影响用户作业，等待每天的23点-7点再进行处理，此时无需在微信群里通知。\n2）挂起对应分区作业。\n统一监控运维平台= 运维管理、\n\n定制大屏剧本执行\n\nTH-HPC\n其他操作 节点操作\n\n TH-HPCA© TH-HPC > THL6\n© TH-HPC\n日 中 存储分区操作\ngris 2EL分区作业恢复\n\nQTH7\nOTH\nO AiReE\nO 用户操作\n© 作灿操作\n\n四 肥各二人矿\n3）重启该ost\n统一监控运维平台\n\nTH-HPC\n\nTH-HPC4PDTH-HPC\na fre] @\n剧本编排日 局 存储分区操作\n加THL5登陆节点部署客户端.， MDS节点部署客户.， 0ST节点部署客户.计算节点部署客户端.\n剧本执行四THL6\n局THL7el\n执行审计Otis查询传感器日志远程协助®\n© 资源操作\n局 用户操作\n© 作业操作\n© 服务操作\n号 数据拷贝\n号 应急操作\n2 批量操作\n®\n统一监控运维平台= 运维管理 / 剧本执行\n\n定制大屏机房运维总览剧本执行\n\n时\n其人操作 节点操作.一输入节点名称\n\nCoa 选择重启/开机/关机\n\nTH-HPC4\n\n器 ce TH-HPC\n中 存储分区",
        "[x-y] | 可以对存储、ion、ln等进行重启、开关机、查看状态等操作 | \nostpower | on|off|reset|status | 可以对存储、ion、ln等进行重启、开关机、查看状态等操作 | \ncfs_stat | cfs_stat -o ostxxx | 查看存储连接数 | \nyhpe | yhpe -a | 查看存储、ION 网络状态 |\n五、故障处理\n5.1 存储故障\n集群 | 管理节点 | 登陆节点 | 分区 | oss | ion | mds\nTH-3F | mn[0-2] | ln[0-2] | thfs1 | oss[0-19] | ion[0-31] | mds[0-3]\nTH-3M1 | mn[6-8] | ln[4-6] | thfs1、thfs3 | oss[40-59] | ion[32-95] | mds[16-19]\nTH-eX | mn[3-5] | th-ex-ln[0-1] | fs2 | oss[20-39] | ion[96-127] | mds[8-11]\nTH-3K | mn[15-17] | ln[7-8]、ln3k | thfs4 | oss[100-119] | ion[128-159] | mds[12-15]\n表 1903集群与存储对应关系\n5.1.1 JBOD扩展卡/风扇/电源/电压状态不正常\n检查jbod故障灯是否亮，如有故障灯，则检查风扇运行状态，如个别风扇是否停转、机柜温度是否过热。\n检查背部4个风扇转速是否统一，如果4个风扇转速都高，则检查jbod盘柜是否完全插入，根据判断可将盘柜重新插拔。\n5.1.2 磁盘状态异常\noss18ost19-5JBOD19-S54磁盘状态异常\n\noss18ost19-5状态异常\n以ost19-5 JOBD19-S54举例\n换盘操作顺序如下：\n其他操作"
    ]
}