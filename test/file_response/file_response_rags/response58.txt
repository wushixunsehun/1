{
    "query": "值班员如何通过运维平台清除登录节点的高负载进程？",
    "summaries": [
        "登录节点故障包括失去连接/宕机和负载过高。对于宕机，可通过堡垒机或监控平台确认节点状态，并通过运维平台重启。对于负载过高，可按CPU或内存查看用户进程，清理高占用进程或用户全部进程以降低负载。",
        "本文档主要描述了如何监控和管理计算节点的资源使用情况，包括查询内存、CPU负载高的进程，清除用户进程或进程ID，以及处理登录节点连接问题、挂载失败、用户登录错误过多、用户提权等常见运维问题。同时，还涉及电源管理操作、用户解锁流程、资源查看及管理节点使用率异常处理等内容。文档旨在为运维人员提供一套完整的操作指南，确保系统稳定运行。",
        "该文本介绍了配置绕路由和恢复路由的脚本使用方法，适用于突发SWM掉电情况，需先用allowerr绕过故障框，恢复后用renew。服务故障时监控系统会自动重启并消警，否则需手动重启。登录节点负载过高时，可通过运维平台查看CPU和内存进程排序，进行清理操作。"
    ],
    "contents": [
        "ost127\nost127\n\n—\n\njobid\n\n1828258\n1818914\n1827402\n\nsftp-server.20654\n\nnode.20912\n1768786\nbash20461\nsftp-server.20528,\n1796896\n1825828\n\n读次数\n\njobid\n\n1818914\n1827772\n1827855\n1827875,\n1827858\n1827871\n1827872\n1827751\n1825099\n1827402\n\n1143\n7.89\n3.73\n245\n137\n4.19\nO71\n0.69\n\n03\n\n1237\n873\n615\n591\n5.33\n5.28\n4.01\n0.94\n\n06\n可以看到排序靠前的jobid。\n3.4 登陆节点故障\n3.4.1 登录节点失去连接/宕机\n监控平台报警如下：\nth-hpct-Ino\n\n失去连接\n\nTH-HPC\n\n登录节点\n\n硬件\n\n。严重\n①首先判断登录节点是否真的宕机，可以通过堡垒机ssh到登陆节点查看状态，也可以通过监控平台的节点操作里查看节点状态。\nTH-HPq\n其他操作 节点操作\n\n下ec 节点编号: th-hpc1-In0\n日 @ TH-HPC\n四 HPC1-127序号: 2523所属集群 TH-HPC硬盘大小: 无硬盘\n日 login节点名称: th-hpc1-In0所履分区: _null硬盘类型. 无硬盘\n\n@ th-hpct-Inoao\n\n:登录节点存储位置: 老机房-TH-HPC-HPC1-127-12.0\n②确认登录节点宕机后，可以通过运维平台直接重启，如下图：\n统一监控运维平台\n\nTH-HPC\n\nTH-HPC4PDTH-HPC\na fre] @\n剧本编排日 局 存储分区操作\n加THL5登陆节点部署客户端.， MDS节点部署客户.， 0ST节点部署客户.计算节点部署客户端.\n剧本执行四THL6\n局THL7el\n执行审计Otis查询传感器日志远程协助®\n© 资源操作\n局 用户操作\n© 作业操作\n© 服务操作\n号 数据拷贝\n号 应急操作\n2 批量操作\n®\n您确定要执行电源管理操作吗?\n3.4.2 负载过高\n（1）选择按CPU或内存查看导致系统负载过高的用户进程。\n统一监控运维平台= 运维管理axa @\n\n定制大屏机房运维总览剧本执行\n\nTH",
        "集群\n\nTH-eX\n\n其他\n\n类型\n\n安全\n\n严重程度\n\n。 Be\n\n=o\n如上图，用户输错密码过多后，监控会报警，报警信息包括集群、登录节点、用户名。值班员参考下面的流程进行处理：\n如果确认用户操作失误导致被锁，需要给用户解锁，按下面的流程操作：\n（1）连接相应集群，点击“其他操作”--“用户操作”“用户登录解锁”。\n定制大屏运维总览故障查询\n\n其他操作 节点操作一\n\nTH-HPC4PDTH-3F\nTH-HPC\n\nHa\n\nTH-eX|\n© TH-3F修改用户组配额修改用户配额查询账户资源查询用户组配额查询用户资源\n\no@\n\n剧本执行号 存储分区操作\n号 资源操作\n（2）在弹出的对话框中输入登陆节点，输入用户名，点击确定。\n您确定要执行用户登录解锁操作吗?x x\n\n取消确认\n5.9 用户提权成xx\n在系统部门微信群里反馈。\n5.10 管理节点使用率超过60%/80%\n通过堡垒机登录管理节点，确认信息，观察使用率增长情况，然后联系二线处理。\n[jump_monuser@mn31%TH3 ~]$\n\n[jump_monuser@mn31%TH3 ~]$ ssh mn\n\nLast login: Tue Nov 22 16:27:12 2022 from 25.8.100.2\n[rootG@mn8 ~]#\n\n[root@mn@ ~]# df -h\n\nFilesystemSize Used Avail Uses Mounted on\ndevtmpfs946© 946 0% /dev\n\ntmpfs946© 946 0% /dev/shm\n\ntmpfs946 4.06 906 5% /run\n\ntmpfs9468 946 0% /sys/fs/cgroup\n/dev/sdal5326 181G 3246 36% /\n\ntmpfs196 16K 196 1% /run/user/42\ntmpfs196 4.0K 196 1% /run/user/0\n\n[root@mno ~]#\n六、支持专员常见问题\n6.1 查看用户计算资源\n连接对应集群，点击“资源操作”，进入“查看用户资源”，如下图：\n统一监控运维平台= 运维管理",
        "allowerr为绕路由，renew为恢复路由\n[root@nn31%TH3 ShellTools]# ./config_swm_allow_err_by rt.sh\nshould input parameter\n\nparal:swm_nrm for example S@05A S007D\n\npara2: function for example allowerr or renew\n\nusage: ./config_swn_allow_err_by rt.sh S003A S0@5A S007D renew\n\n[root@nn31%TH3 ShellTools]# ff\n本脚本适用于突发swm掉电情况，yhst查到确实掉电了，先用绕路由工具将该框绕过去，然后再查询掉电原因。\n操作说明：执行脚本，输入参数为框+allowerr，板卡恢复之后用renew。\n5.3 服务故障\n服务出故障后监控系统会自动重启服务，然后报警自动消掉。\n如果报警没消掉，值班人员需要通过运维平台手动重启服务。\n在服务操作页面可以查看服务状态，如下图所示：\n统一监控运维平台 Epos\n\nama\n\nTH-3F\n TH-HPCAQ TH-3F\n TH-HPC\n\n剧本编排 TH-eX\n\nin\n\nSIE @)\n\n剧本执行\n\n执行审计\n您确定要执行服务操作操作吗?\n5.4 登录节点负载过高\n查询对应节点，选择“查看负载”，“cpu进程排序”和“内存进程排序”。\n统一监控运维平台= 运维管理Q x wm\n\n8B 监控管理- a\n\nD fen\n\nTH-3F\n其他操作一一\nCo]os 节点编号: In0\n日 ce TH-3F\n剧本编排日 Vo25序号: 4423所属集群 TH-3F硬盘大小. 无硬盘\n日 login节点名称: In0所属分区: _null硬盘类型: 无硬盘\n全节点类型: 登录节点存储位置: 1903机房-TH-3F-VO-25-节点状态: 连接成功 |\n23.0\n查看cpu负载高的进程\n查询日志查询内存清除用户进程清除进程cpu进程排序\n\n查看内存负载高\n的进程\nIn0:cpu进程排序 *\n\nPID|X%cpPu %nEM| vsz RSS TTYSTAT START",
        "吗?\n3.4.2 负载过高\n（1）选择按CPU或内存查看导致系统负载过高的用户进程。\n统一监控运维平台= 运维管理axa @\n\n定制大屏机房运维总览剧本执行\n\nTH-HPC\n其他操作\n\nth-hpct-IndQ\n\n5cq 节点编号: th-hpc1-Ind\n\n日| s TH-HPC\nFRE: 2523所属集群 TH-HPC\n\n剧本编排~加 HPC1-127\n日 login节点名称: th-hpc1-In0所属分区:_null\na节点类型: 登录节点存储位置: 老机房-TH-HPC-HPC1-\n127-12.0\n执行审计\n查询日志查询内存清除进程清除用户进程\nth-hpc1-In0:cpu进程排序 X\n\n天对执行\n命令输出:\n\nPLAY [a] ws本洒洒洒洒末末洒洒宁洒洒末末\n\nchanged: [121.16.3.1]\n\nSPU/内存的使用排序\n\nok: [121.16.3.1] =>\nesRBFES, EEZIDmt进程命令\nVSZ RSS TTYSTAT STARTTame [command™,]\nangyq 5735@.2 308900 148640 pts/101 Rt 09:04 10:28 ncl 16.ncl”,\nroot33364 12.6 0.0 124128 6408 ?S69:15 “6:63 /bin/sh /usr/local/bin/rkhunter -c -\ninxubo 21825 5.@ @.@ 125488 3844 pts/128 Ss+ 89:15 ”9:68 -bash\"，\n“wangyq 40400 4.9 0.2 308896 148628 pts/101 T 09:02 0:37 ncl 16.ncl\",\n\n\"nslcd2398 3.2 ©.0 442336 1432 ?Ssl 4月16 1429:26 /usr/sbin/nslcd\",\n\n\"root888 2.1 0.0 95640 38540 ?Ss 4月16 958:11 /usr/lib/systemd/systemd-journald\",\n\"linxubo 22342 2.0 @.@ 59000 2240 ?Ss 09:15 @:0@ /usr/libexec/openssh/",
        ":11 /usr/lib/systemd/systemd-journald\",\n\"linxubo 22342 2.0 @.@ 59000 2240 ?Ss 09:15 @:0@ /usr/libexec/openssh/sftp-server\",\n\"root2264 1.4 @.1 5182264 106456 ?SLsl 4月16 644:38 /opt/thsre/exporters/telegraf/telegr\n“root21684 1.0 0.0 159956 5688 ?Ss 9:15 0:0 sshd: linxubo [priv]\",\n\n\"linxubo 22501 1.0 6.9 119748 2028 ?Ss 69:15 @:0@ bash -c while true; do sleep 1;head\n图：按CPU使用率查看用户进程\n（2）清理用户的某个进程。通过第一步得到使用率高的进程ID。\n统一监控运维平台运维管理 、\n\nSAR 。 机房 运维总览\nTH-HPC\n其他操作 节点操作\nth-hpct-IndQ\non?\n日 @ THHPC\n剧本编排日 HPC1-127\nlogin\n剧本执行© th-hpct-Ind\n\n节点编号: th-hpc1-In0\n\n序号: 2523\n节点名称: th-hpc1-In0\n\n节点类型: 登录节点\n\n查询内存\n\n所属集群 TH-HPC\n\n所属分区:_null\n\n存储位置: 老机房-TH-HPC-HPC1-\n127-12.0\n\nvo 清除单个进程\n\n清除用户进程\n\n硬盘大小: 无硬盘\n\n节点状态: 连接成功 |\n\ncpu进程排序\n统一监控运维平台\n\n定制大屏me\n\n运维总览剧本执行\n\n其他操作 。 节点操作\n\nth-hpc1-In0\n\n日 @ THHPC\n©) HPC1-127\n\nlogin\n\n© th-hpct-Ind\n\n存储位置: 老机房-TH-HPC-HPC1-\n127-12.0\n\n查询日志\n\n查询内存SHE=a\nAIRS\n\n硬盘大小: 无硬盘\n硬盘类型; 无硬盘\n\n节点状态: sea\n\ncpu进程排序\n（3）清除用户全部进程。通过第一步得到使用率高的用户名",
        "nm wm wm\n\noo\n选择清除负载高的用户进程，可选择杀用户也可选择杀进程，输入对应的用户名或进程id。\n统一监控运维平台= 运维管理Q x -» &\nTH-3F\n其他操作一一\nCoos 节点编号: In0\n日 ce TH-3F.;\navi日 Vo-25ee所ETBUN FA\n日 login节点名称: In0所属分区: _null硬盘类型: 无硬盘\nEE节点类型: 登录节点存储位置: 1903机房-TH-3F-VO-25-节点状态: 连接成功 |\n23.0\n查询日志查询内存cpu进程排序mem进程排序\n\n者和有清除单个进程\n5.5 登陆节点失去连接\n1）登录运维平台，依次选择①“剧本执行”、②“其他操作”，③点击连接“对应集群”、④“其他操作”、⑤“电源管理”进行关机、⑥“电源管理”进行开机。\n或者到机房按电源重启。\n统一监控运维平台\n\nBa 监控管理\n\nvs\n览\n\n剧本编排\n\n剧本执行\n\n执行审计\n\nama\n\nTH-HPC4\nTH-HPC\nTH-eX\n\nTH-3F\n\nQ TH-3F\n\n1903 RSI\n\nANsipmibs\n\nION节点部署客户\n\n查询传感器日志\n\nSRT RESP in...\n\nMDS节点部署客户\n\nOST节点部署客户\n您确定要执行电源管理操作吗?\n\n+节点名 | |\n\n+动作\n\n取消\n\n确认\n2）若重启后出现登陆节点挂载相关报警，参照5.7处理\n5.6 监控节点服务状态异常\n观察10分钟，如果报警持续存在，联系二线同事确认状态。\n5.7 登陆节点挂载失败\n1）执行df确认挂载是否正常\n2）若卡住，确认存储状态是否正常\n3）手动挂载\n5.8 用户从登录节点登录错误xx次\n描述\n\nliuzhonglan从th-ex-In1登录错误13次\n\n集群\n\nTH-eX\n\n其他\n\n类型\n\n安全\n\n严重程度\n\n。 Be\n\n=o\n如上图，用户输错密码过多后，监控会报警，报警信息包括集群、登录节点、用户名",
        "的进程\n查询日志查询内存清除用户进程清除进程cpu进程排序\n\n查看内存负载高\n的进程\nIn0:cpu进程排序 *\n\nPID|X%cpPu %nEM| vsz RSS TTYSTAT START\nendorse ofies 64612 pts/22R+ 17:20\n204912170 5720 4008 ?Ss 17:04\n2049643.9 5720 3988 ?Ss 17:04 4:20 /usr/1lib/openssh/sftp-server\",\n\n6801+2 5169068 282524 ?SLsl May28 77:48 /opt/thsre/exporters/telegraf/teleg\n1310470.9 6100 4520 ?Ss 15:10 7:49 /usr/lib/openssh/sftp-server\",\n1317677.9 6100 4460 ?Ss 15:10 7:48 /usr/lib/openssh/sftp-server\",\n\n6816.8 127208 36764 ?S1 May28 66:56 /opt/thsre/thmc --web.disable-expor\n2293036-@ 1110132 32268 ?SNs1 17:50 @:00 /usr/libexec/tracker-extract\",\n564879+9 1353888 1262020 ?S1 12:17 11:08 /thfs1/home/fengxu/.vscode-server/e\n1142898.9 21000 7028 ?14:27. 6:37 sshd: zhangmg@notty\",\n\n1143679.9 21368 7304 ?14:27. 6:36 sshd: zhangmg@notty\",\n1142647.9 21088 6968 ?14:27. 6:25 sshd: zhangmg@notty\",\n114304820920 6984 ?14:27. 6:25 sshd: zhangmg@notty\",\n了\n>\n\n114323021224 720014:27. 6:21 sshd: zhangmg@notty\",\nAAADARQ了DDFIF ER2E4AASIE692 echd: shanomoAnntty\"\n\nyWwwwwwuvr PRA UO\nDR RERRYWOKwDOEWY\n> 29 SSS9S9999929 9090\n\nae)\nnm wm wm\n\noo\n选择清除负载高的用户进程，可选择杀用户也可选择杀进程，输入对应的用户名或进程id。\n统一监控运维平台= 运维管理Q x -»"
    ]
}