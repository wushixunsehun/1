{
    "query": "nvidia-smi 命令怎么用？使用命令后可以获得什么信息？",
    "summaries": [
        "该文本描述了在跨节点运行VASP计算时的SBATCH脚本配置，包括指定每个节点使用的GPU数量、每个GPU的CPU数量，以及启动MPI并行任务的命令。还提供了INCAR文件的参数设置，如系统名称、精度、收敛条件等。最后提到通过nvidia-smi查看GPU使用情况。",
        "本文介绍了通过 `yhrun jobid=<job_id> nvidia-smi` 命令查询 GPU 利用率的方法，适用于 k80 集群。测试显示，VASP 可成功查询 GPU 使用情况，而 LAMMPS、Python、GROMACS 等软件无法查询，可能与作业调度系统有关。同时，查询过程中出现“Requested nodes are busy”提示，表明节点可能处于忙碌状态。",
        "该文本显示了使用nvidia-smi命令查看的GPU状态信息。GPU 0正在使用98%的计算资源，占用1542MiB显存，而其他GPU（1、2、3）的使用率均为0%。进程显示有一个Python进程在使用1539MiB显存。用户程序仅使用了GPU的25%计算资源，存在资源浪费，建议进行计算调整以提高效率。"
    ],
    "contents": [
        "N，跨节点使用时必须指定-N\n#SBATCH gpus-per-node=2\n#SBATCH cpus-per-gpu=1\nEXE=vasp_std  # choose one vasp version to run. e.g. vasp / vasp_ncl / vasp_gam / vasp_neb ...\ntime mpirun -oversubscribe  -np 2  $EXE\n提交作业\nyhbatch sub.sh\nINCAR\n$ cat INCAR\nSYSTEM = Anatase\nISTART = 0\nICHARG = 2\nPREC=Normal\nLREAL = .F.\nIBRION = -1\nISIF=3\nNSW = 0\nPOTIM = 0.5\nEDIFFG 0.05\nENCUT = 400 eV\nNELM = 100\nEDIFF = 0.1E-04\nLCHARG = .T.\nLWAVE = .T.\nISMEAR = 0\nSIGMA = 0.2\nALGO = Fast\nKPAR = 2\nNCORE = 1\nNSIM = 32\n查看GPU利用情况\nssh 到计算节点\n$ nvidia-smi\nThu Sep  1 16:43:10 2022\n++\n| NVIDIA-SMI 495.29.05    Driver Version: 495.29.05    CUDA Version: 11.5     |\n|+++\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|                               |                      |               MIG M. |\n|++|\n|   0",
        "【测试中】利用yhrun查询gpu利用率\n**标签**: 无标签\n**创建时间**: 2023-11-16 11:13:20\n**更新时间**: 2023-11-17 11:13:39\n**作者**: 杜思慧\n**1. 查询语句**\n#该方法也适用于k80集群\nyhrun jobid=<job_id> nvidia-smi\n2.测试情况\n单卡查询：\n目前仅vasp可同通过该方法查询，其他软件无法查询疑似和作业调度系统有关\nvasp\n[dush2Gth-hpc4-Lng ~]$ yhq\nJOBID PARTITION     NAME     USER ST       TIME NODES NODELIST(REASON)\n1443650       gpu   sub.sh    dush2 R       2:06      1 gn36\n[dush2@th-hpc4-1tn0 ~]$ yhrun jobid=1443650 nvidia-smi\nThu Nov 16 11:12:51 2023\n+十\n| NVIDIA-SMI 495.29.05    Driver Version: 495.29.05    CUDA Version: 11.5\n|  2-2 rere rere rere re eee ee++十\n| GPU Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC\n| Fan Temp Perf Pwr:Usage/Cap|         Memory-Usage | GPU-Util Compute M.\n|                        |                MIG M. |\n一一=一一一一一一一一一一=一一一一一一一一一一一一一一一一一二一一一一一一一一一一一一一一=一一=一一=一+一|\n|   9 NVIDIA A100 80G... Off | 00000000:4B:00.0 Off",
        "0%      Default |\n|                               |                      |                  N/A |\n++++\n|   3  Tesla K80           Off  | 00000000:8C:00.0 Off |                    0 |\n| N/A   34C    P8    30W / 149W |      3MiB / 11441MiB |      0%      Default |\n|                               |                      |                  N/A |\n++++\n++\n| Processes:                                                                  |\n|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n|        ID   ID                                                   Usage      |\n||",
        "Usage      |\n||\n|    0   N/A  N/A     29423      C   ...conda_2020.07/bin/python3     1539MiB |\n++\n```\n4. 问题\n用户该程序只能使用GPU的25%计算资源，有些浪费，联系用户进行计算调整\n[gtcao@gn2 ~]$ nvidia-smi\nThu Sep 30 09:53:27 2021\n++\n| NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: 11.4     |\n|+++\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n|                               |                      |               MIG M. |\n|++|\n|   0  Tesla K80           Off  | 00000000:84:00.0 Off |                    0 |\n| N/A   56C    P0   144W / 149W |   1542MiB / 11441MiB |     98%      Default |\n|",
        "0 |\n| N/A   56C    P0   144W / 149W |   1542MiB / 11441MiB |     98%      Default |\n|                               |                      |                  N/A |\n++++\n|   1  Tesla K80           Off  | 00000000:85:00.0 Off |                    0 |\n| N/A   23C    P8    30W / 149W |      3MiB / 11441MiB |      0%      Default |\n|                               |                      |                  N/A |\n++++\n|   2  Tesla K80           Off  | 00000000:8B:00.0 Off |                    0 |\n| N/A   22C    P8    26W / 149W |      3MiB / 11441MiB |      0%      Default |\n|                               |",
        "一一一一一一一一一一一一一一一一一二一一一一一一一一一一一一一一=一一=一一=一+一|\n|   9 NVIDIA A100 80G... Off | 00000000:4B:00.0 Off |                    0\n| NMA 53C    PQ 300W / 300W | 37811MiB / 81070MiB |    100%      Default\n|                                 |                        |              Disabled |\nf4+4++\n+十\n| Processes:\nGPU   GI   cI        PID Type   Process name                  GPU Memory\nID ID                                                   Usage\nlammps。python，gromacs等均无法查询\n[dush2@th-hpc4-1n1 accelerate]$ yhq\nJOBID PARTITION     NAME     USER ST       TIME NODES NODELIST(REASON)\n1443675       gpu   sub.sh    dush2 R       0:15      1 gn36\n[dush2@th-hpc4-1n1 accelerate]$ yhrun jobid=1443675 nvidia-smi\nlyhrun: Job 1443675 step creation temporarily disabled, retrying (Requested nodes are busy)"
    ]
}