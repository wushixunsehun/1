{
    "query": "Linux存储系统中可用的存储空间还剩多少？",
    "summaries": [
        "BK OST 上的索引和点总数不能轻易更改，因此在格式化时应预留足够空间以避免后续添加存储的麻烦。默认情况下，ldiskfs 文件系统会预留 5% 空间，且每个 OST 预留 400MB，每个 MDT 预留 4GB 用于日志。ZFS 作为后端文件系统时，空间分配更动态，但仍有约 3% 空间用于元数据。MDT 空间需求取决于文件数量、条带数、ACL 和扩展属性等因素，通常为文件系统容量的 1%-2%。对于 ldiskfs MDT，需根据文件大小计算最小空间，如平均文件大小为 5MB，则需约 400GiB。若文件较小（如 4KB），则需增加空间。OST 空间需求取决于用户使用模式，Lustre 默认估计较保守，可根据实际调整。可通过增加 MDT 或扩展存储空间来提升索引节点总数和性能。",
        "Lustre 文件系统内存需求包括客户端、MDS 和 OSS。客户端推荐至少 2GB RAM。MDS 内存需求取决于客户端数量、目录大小和负载，每个文件约占用 2KB 内存。默认日志大小为 4096MB，故障切换时需翻倍。计算示例显示，1024 个客户端、12 个交互式客户端和 600 万文件需至少 16GB RAM。OSS 内存需求包括服务线程、读取缓存等，推荐最小 32GB RAM，用于 8 个 OST 设备。额外内存可提升性能。",
        "该文本包含系统资源使用情况和一些进程信息。内存使用显示总内存为257607.1 MiB，其中158849.9 MiB空闲，67550.0 MiB已用。交换空间为0.6 MiB，全部空闲。此外，还列出了一些进程名称、用户、CPU使用率及内存占用等数据，如orca_scfhess_mp、hehong、thlog、systemd等进程及其相关数值。"
    ],
    "contents": [
        "实际使用的空间大小与很多因素有关，如每个路径下文件数量、每个文件的条带数、文件是否含 ACL 或用户扩展属性、每个文件的硬链接数。Lustre 文件系统元数据所需的存储通毅是文件系统容量的 1% - 2%，具体取决于文件平均大小。WHR Lustre 2.11 或更高版本使用第 20 章，MDT 上的数据 (DoM) 功能，则 MDT 空间通DAK AAAS IDEN 5% 或更多,这取决于文件系统内小文件的分布和lod.*.dom_stripesize对使用的 MDT 和文件布局的限制。对于基于ZFS HY MDT 文件系统，在MDT Ail OST 上创建的索引和氮的数量是动态的，因此不太需要预先确定索引节氮的数量，但是仍然需要根据总文件系统的大小而考sk MDT 的总空间大小。例如，如果文件平均大小为SMiB ，而您有 100TiB 可用的 OST 空间，那么您可以计算出每个MDT 和OST 的索引节点最小总量: (500 TB * 1000000 MB/TB) / 5 MB/inode= 100M inodes.建议您将 MDT 43 /A) B/E A / AR TEN ft, DOT PEAROR DJ, BT防文件平均大小小于预期。因此，ldiskfs MDT 的最小空间为: 2 KiB/inode x 100 millioninodes x 2 = 400 GiB Idiskfs MDT.注意如果文件大小的中间值非解小，例如4KB，则 MDT 将为每个文件使用与 OST 上相同的空间，每个信息节点的MDT 空间应相应增加，以考虑每个信息节氮的额外数据50\nLustre 文件系统操作手册 译者:As大空间使用情况:如果平均文件大小非毅小，例如只有 4KB ，那么每个文件在MDT 上所占用的空间将会和在 OST 上一样多。因此在这种情况下，强烈建议使用MDT 上的数据。考虑到每个索引布扣的额外数据空间使用情况，每个索引节点上的 MDT 至间也应做出相应的增加:6 KiB/inode x 100 million inodes x 2",
        "分配 RPC-sized MB JIO 的缓冲区，因此不需要通过 IO 请求来分配和释放缓冲区。。0SS 读取缓存: OSS 读取缓存提供 OSS 数据的只读缓存，使用浓规的 Linux 页面缓存来存储数据。与 Linux 操作系统中的常规文件系统的缓存一样，0SS 读取绥存使用所有可用的物理内存。适用于 MDS 的计算也同样适用于从 OSS 访问的文件，但因为其负载分布在更多HY OSSs “RE, (AlKKZE MDS 下列出的锁、inode 缓存等所所需的内存数也分散在这些OSS 节点上。由于这些内存需求，应将下面的计算作为确定 OSS 节点所需的最小RAM 大小。5.5.3.1 计算 OSS 内存需求4 8 “+ OST fy OSS 的推荐最小RAM 大小计算如下: Linux 内核与用户空间和守护进程的内存 = 1024 MB 以太网/TCP 23K / REWER DX (16 MB * 512 线程)= 8192 MB 1024MB 日志大小*8个OST 设备=8192MB 每个OST IO 线程的 16 MB 读/写操作缓存* 512个线程 = 8192 MB 2048 MB 文件系统读取缓存* 8 OST = 16384 MB 1024 * 4 核客户端*1024 个文件/核* 2kB/文件 = 8192MB 12 个交互式客户端* 100,000 个文件* 2kB/文件 =2400MB 2,000,000 文件〈附加工作集) * 2kB/文件 = 4096MB DLM 锁+ 文件系统元数据总量=31072MB 每个OSS DLM 锁+ 文件系统元数据= 31072MB/4 OSS = 7768MB {iti值) 每个OSS RAM 最小需求=32 GB 〈估值)预先分配的绥神区就消耗了大约 16 GB，文件系统和内核则至少还需要附加的 1GB。因此，对于非故障切换配置，使用8 个OST 的 OSS “HY RAM 至少应为 32 GB。在 OSS 上添加额外的",
        "BK OST 上的索引和点总数不能被轻易更改。因此，在格式化时应创建足够多的索引节点，并预见到短期内的使用情况，预留一部分增长空间，以避免添加额外存储的麻烦。默认情况下，由 Lustre 服务右用作存储用户数据对象和系统数据的 ldiskfs 文件系统会预留 5% 的空间，该空间不能被 Lustre 文件系统使用。此外，Lustre ldiskfs 文件系统在每个OST 上预留 400 MB 空间，每个MDT 上预留 4GB 空间用来放置日志，同时在日49\nLustre 文件系统操作手册 译者:志之外要预留少量空间，放置限额统计数据。这个预留空间不能用于一般存储，因此在保存任何文件对象数据忆前，至少 OST 上的这些空间已被占用。当MDT或OST 使用ZFS 作为后端文件系统时，索引和氮和文件数据的空间分配是动态的，索引和所可投需分配。每个索引节氮人至少需要 4kB 的可用空间〈如有果没有蚀像)，除此忆外，还有目录、内部日志文件、扩展属性、ACL 等其他开销。ZFS 也同样预贸了全部存储空间 3% 左右，用作内部的和元余的元数据，这部分空间不可为 Lustre所用。由于扩展属性和 ACL 的大小高度依赖于内核版本和站氮策略，因此最好高售所需索引节氮数目所对应的的空间大小。任何多余的空间都可用于存储更多的索引节氮。5.2.1 确定 MGT 空间需求MGT 所需空间通前小于 100MB ，该大小是由 MGS 管理在 Lustre 文件系统集群中管理的服务需总数决定的。5.2.2 确定 MDT 空间需求在计算 MDT 大小时，一个需要考虑的重要因素是存储在文件系统中的文件数量，Ii] MDT 上每个索引节点至少需要 2 KIB 的可用空间。由于 MDT aii AY RAID-1+0 镜像，所需的总存储量还须翻倍。请注意，每个 MDT 实际使用的空间大小与很多因素有关，如每个路径下文件数量、每个文件的条带数、文件是否含 ACL 或用户扩展属性、每个文件的硬链接数。Lustre 文件系统元数据所需的存储",
        "77.3 id, 0.0wa, 0.2 hi, 0.2 si, 0.0 st\nMiB Mem : 257607.1 total, 158849.9 free, 67550.0 used, 31267.2 buff/cache\nMiB Swap:      0.6 total,      0.0 free,      0.0 used. 173286.2 avail Mem\n8495872\n8494940\n7.6                                 orca_scfhess_mp\n7.6\n8512048 7.64\n7.6\n7.6\norca_scfhess_mp\norca_scfhess_mp\norca_scfhess_mp\norca_scfhess_mp\norca_scfhess_mp\norca_scfhess_mp\norca_scfhess_mp\n11569768 hehong 20\n1569769 hehong 20\n1569771 hehong 20\n1569772 hehong 20     8494684         11288\n9\n9                 11772\n9\n9\n9\n1569773 hehong 20 © 8495008 ”7.69 11176\n9\n9\n9\n9\n9\n9\n9\n9 11892\n8495808      9g 11484\n9\n1569770 hehong 20     8495940 7.6g 11772\n1569775 hehong 20     7650024 6.89 11132\n2505 root      20 © 3143512 69988 38868                         thlog\n1 root      20      265996 11912 8984                         systemd\n2 root      20           9      9      9                         kthreadd\n3 root",
        "上的内存大小。MDS 上没有所谓当前打开文件的\" SUR\",为它们只与给定客户端的接口相链接。每个客户端进程最多能打开几王个文件，这取决于它的ulimit。默认情况下，ldiskfs MDT 单个文件的最大条市数为 160 个 OST。在格式化MDT 时使用--mkfsoptions=\"-O ea_ inode\"可增加该值，或在格式化 MDT 后使用une2fs -O ea _ inode来启用并改变它。56\nLustre 文件系统操作手册这ay5.5. 确定内存需求5.5.1 客户端内存需求推荐使用至少2 GB RAM 的客户端。5.5.2 MDS 内存需求MDS 内存需求由以下因素决定:。 客户最大数量。 目录大小。 服务器上负载情况MDS 使用的内存数量与系统中有多少客户端，以及饭们在工作集中使用多少文件有关。它主要是由客户端一次可以容纳的锁数量决定。客户端持有的锁的数量因服务需上的负载和闪存可用性而异。交互式客户端有时可以容纳超过 10,000 个锁。在 MDS 上，每个文件大约使用2KB 的内存，包括 Lustre 分布锁管理融 (DLM) 锁和当前文件的内核数据结构。与从存储读取数据相比，将文件数据放在缓存中可以提高元数据性能 10fia ESMDS 内存需求包括:“文件系统元数据: 需要合理数量的RAM 以支持文件系统元数据。虽然文件系统元数据的数量没有硬性的限制，但如果有更多的RAM 可用，则可以减少通过磁盘了O 检索元数据的频率。“网络传输: 如果您使用的是 TCP 或其他使用系统内存来发送或接收缓训的网络传输，那么也须将这些内存需求考虑在内。“日志大小: 默认情况下，用于每个 Lustre ldiskfs 文件系统的日志大小为 4096 MB.这占用了每个文件系统的 MDS A EAI Cat) RAM.。 故障切换配置: 如果 MDS 节氮用于从另一个节点进行故障转移，那么每个日志所需的RAM 应翻倍。当主服务融发生故障时，备份服务硕才有能力处理附加的负载。5.5.2.1 计算 MDS 内存需求默认情况下，文件系统日志",
        "上的数据。考虑到每个索引布扣的额外数据空间使用情况，每个索引节点上的 MDT 至间也应做出相应的增加:6 KiB/inode x 100 million inodes x 2 = 1200 GiB ldiskfs MDT如果 MDT WAS RA, MSS AFC Gill BET OC AF TT S38 OST 上的空间无法被使用。这种情况下，1fs df -1和aqf -imp ay LAB HSC HE ASC ary 2 AR S|的数量，以匹配 OST 上可用对象的总数量。请确保在格式化文件系统之前确定文件系统所需 MDT 的合适大小。大存储大小允许，可在文件系统格式化后增加索引和氮数量。对于 ldiskfs MDT 文件系统，对于 ldiskfs MDT 文件系统，如果底层块设备在 LVM逻辑卷上且大小可扩展，则可使用 resize2fs 工具。对于 ZFS, ATYSAIATEY Cea AY)VDEVs 到 MDT 池中，以增加用于索引市氮存储的总空间。和对绰氮将根据空间增加的大小按比例描加。请注意，1fs df -1对于ZFS MDT Al] OST 所报告的总索引节点量和空闲索引节扣量是基于每个索引和点所使用的当前空间平均大小来估计的。当 ZFS 文件系统首次格式化时，相关空闲索引节氮数量估计将会很保守〈低) 。这是由于相对和前规文件，为内部 Lustre 元数据存储所创建的目录占了很高的比率。但该估计值会随着普通用户创建更多文件而提高，而文件平均大小将更好地反映实际的站点使用情况。使用DNE 远程目录特性通过在文件系统中配置附加的MDTs，可增加 Lustre 文件系统索引和氮总数、提升总体元数据性能5.2.3 确定 OST 空间需求对于OST，每个对象所占用的空间取决于运行在系统上的用户或应用程序的使用模式。Lustre 软件默认的对象平均大小估计较为保守 〈10GiB 的 OSTs 上每个对象 64KiB，16TiB 或更大的 OSTs 上每个对象 1MiB)。如果您确信应用程序的文件平均大小与此不同，您可以指定不同的",
        "一个节点进行故障转移，那么每个日志所需的RAM 应翻倍。当主服务融发生故障时，备份服务硕才有能力处理附加的负载。5.5.2.1 计算 MDS 内存需求默认情况下，文件系统日志使用4096MB。额外的 RAM 用于存储更大的工作集组存文件数据，通稼它并不处于活跃状态，但应保持热度以提升访问速度。在没有锁的情况下，每个文件保存在缓存中大约需要 1.5 KB 内存。例如，在 MDS 上的单个MDT，有 1024 个客户靖、12 个交互节氮、一个 600 万个文件的工作集〈其中 400 万个文件在客户端缓存上):57\nLustre 文件系统操作手册 译者:As大操作系统开销 = 1024 MB 文件系统日志=4096MB 1024 * 4 4% Fe PF oh * 1024 个文件/核* 2KB = 4096MB 12 个交互式客户端* 100,000 个文件* 2KB = 2400 MB 2,000,000文件〈附加工作集) * 1.5kB/文件=3096 MB因此，具有这种配置的MDT 的最小需求是至少 16 GB 的RAM。但是，额外的闪存可以显者提高性能。对于包含 100 万或更多文件的目录，更多的内存大有神益。例如，当一个客户端要随机访问 1000 万个文件中的一个时，有附加的内存来进行缓存可以大大地提高性能。5.5.3 OSS AER在为一个 OSS 下氮规划硬件时，须考虑 Lustre 文件系统中几个组件的内存使用情Die CU: 上日志、服务线程、文件系统元数据等)。愉外，也须考虑 OSS 读取缓存特性，因其在 OSS 贡点上绥存数据时将消耗内存。除上文中提到的 MDS 内存需求外，OSS 的内存要求包括:。 服务线程: OSS 节点上的服务线程为每个 ost_io 服务线程预分配 RPC-sized MB JIO 的缓冲区，因此不需要通过 IO 请求来分配和释放缓冲区。。0SS 读取缓存: OSS 读取缓存提供 OSS 数据的只读缓存，使用浓规的"
    ]
}