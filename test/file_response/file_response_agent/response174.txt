{
    "query": "如何在HPC4上查询V100的gpu状态？给出具体步骤。",
    "summaries": [
        "TH-HPC4 A100 GPU 单卡双精度浮点性能 HPL 测试报告显示，其性能为 1.021e+04 GFlops，超过理论值 9.7 GFlops 的 105.26%。测试过程包括注册 NVIDIA 账号、获取 API KEY、登录容器镜像仓库、下载并配置 HPL 运行脚本。测试文件包含 HPL-dgx-a100-1N-n1-nscc.dat，设置参数如问题规模、块大小、进程网格等，以评估 GPU 计算性能。",
        "本文介绍了如何通过修改脚本查询HPC4 GPU利用率。在sub.sh中，于yhrun语句前添加“nvidia-smi dmon > nvi_1.log &”可持续记录GPU利用率，若需限制时间，则可添加timeout命令。该方法适用于程序运行期间的GPU使用情况监控。",
        "TH-HPC4 GPU 分区提供查看 GPU 卡使用率的功能。用户可通过命令 `getgpu` 查看当前 GPU 使用情况，包括总显存、已用显存及使用率等信息。`getgpulog` 可查看最近 48 行每 30 分钟的统计记录，`getgpufile` 则直接打开日志文件。此外，可通过 `yhq | grep gpu` 查看哪些用户正在使用 GPU。该功能解决了 mix 状态下无法直观查看 GPU 使用率的问题。"
    ],
    "contents": [
        "【已解决】HPC4 GPU利用率查询\n**标签**: 无标签\n**创建时间**: 2023-01-11 14:55:40\n**更新时间**: 2023-05-09 15:59:05\n**作者**: 杜思慧\n**1.查询脚本**\n**sub.sh**\n#!/bin/bash\n#SBATCH partition=gpu1\n#SBATCH -N 1\n#SBATCH gpus-per-node=1\n#SBATCH cpus-per-gpu=8\n#timeout 1m nvidia-smi dmon > nvi_1.log &\nnvidia-smi dmon > nvi_1.log &\nyhrun python train.py\n**2.使用说明**\n在sub.sh中的yhrun语句前加上nvidia-smi dmon > nvi_1.log & , 会从程序运行开始到程序运行结束一直查询gpu利用率；若加上时间限制，则只在规定时间内查询gpu利用率。",
        "TH-HPC4 A100 GPU 单卡双精度浮点性能 HPL 测试报告\n**标签**: a100,  hpl,  性能测试\n**创建时间**: 2023-04-11 09:57:12\n**更新时间**: 2023-04-11 09:57:12\n**作者**: 郑刚\n**问题**：TH-HPC4 A100 GPU 单卡双精度浮点性能 HPL 测试报告\n1. 文档说明\n此文档描述了TH-HPC4 集群 A100 GPU 单卡双精度浮点计算性能的测试数据。\n2. 测试报告\n2.1 测试结果\n通过本次测试获得如下性能结果：TH-HPC4 A100 GPU 单卡双浮点计算性能为 1.021e+04 GFlops，是理论双浮点性能（9.7GFlops）的 105.26%。\n2.2 测试流程（过程记录）\n（1） 注册 NVIDIA 官网，获得账号密码；\n（2） 使用账号密码登录官方，并通过 CONFIGURATION 获得 API KEY\n（3） 使用 docker login nvcr.io 登录，输入 Username 和 Password（API KEY）\n（4） 使用下载命令获得容器镜像：\n$ singularity pull docker-login hpc-benchmarks:21.4-hpl.sif docker://nvcr.io/nvidia/hpc-benchmarks:21.4-hpl\n（5） 参考容器中的示例文件，根据本集群环境配置，针对性修改 hpl.sh 运行脚本 和 HPL-dgx-a100-1N.dat 脚本。\nhpl-nscc.sh 内容为：\n#!/bin/bash\n# file: hpl-nscc.sh\n/workspace/hpl-linux-x86_64/xhpl /my-dat-files/HPL-dgx-a100-1N-n1-nscc.dat\nHPL-dgx-a100-1N-n1-nscc.dat 内容为：\nHPLinpack benchmark input file\nInnovative Computing Laboratory, University of Tennessee\nHPL.out      output file name (if any)\n6            device out (6=stdout",
        ", University of Tennessee\nHPL.out      output file name (if any)\n6            device out (6=stdout,7=stderr,file)\n1            # of problems sizes (N)\n50240       Ns\n1            # of NBs\n288          NBs\n0            PMAP process mapping (0=Row-,1=Column-major)\n1            # of process grids (P x Q)\n1            Ps\n1            Qs\n16.0         threshold\n1            # of panel fact\n0 1 2        PFACTs (0=left, 1=Crout, 2=Right)\n1            # of recursive stopping criterium\n2 8          NBMINs (>= 1)\n1            # of panels in recursion\n2            NDIVs\n1            # of recursive panel fact.\n0 1 2        RFACTs (0=left, 1=Crout, 2=Right)\n1            # of broadcast\n3 2          BCASTs (0=1rg,1=1rM,2=2rg,3=2rM,4=Lng,5=LnM)\n1            # of lookahead depth\n1",
        "【已解决】TH-HPC4 GPU 分区 GPU卡使用率查看\n**标签**: hpc4,  gpu,  使用率\n**创建时间**: 2022-10-19 15:58:21\n**更新时间**: 2022-10-19 15:58:47\n**作者**: 郑刚\n**问题**：TH-HPC4 GPU 分区 GPU卡使用率查看\n需求\n由于存在 mix 状态，因此我们希望能够直观的获得 gpu 卡的使用率\n使用方法\n# 登录 mengxf 账号（密码找郑刚要）\n$ ssh mengxf@192.168.4.10\n# 查看 gpu 的使用率\n$ getgpu\n#Date               Total  Used   Used(%)   Total(GPU) Used(GPU)  Used(GPU%) Total(GPU1)  Used(GPU1) Used(GPU1%)\n2022-10-19-15:54:01 36     9      25.00     20         9          45.00      16           0          0\n# 查看最近一段时间的gpu使用率（每 30 分钟 统计一次，显示最近 48 行）\n$ getgpulog\n#Date               Total  Used   Used(%)   Total(GPU) Used(GPU)  Used(GPU%) Total(GPU1)  Used(GPU1) Used(GPU1%)\n2022-10-19-13:00:00 36     9      25.00     20         9          45.00      16           0          0\n2022-10-19-13:30:00",
        "45.00      16           0          0\n2022-10-19-13:30:00 36     9      25.00     20         9          45.00      16           0          0\n2022-10-19-14:00:00 36     9      25.00     20         9          45.00      16           0          0\n# 查看全部log\n$ getgpufile\n# 直接打开 log file\n# WARNNING !!! 千万别删东西!\n补充：查看谁在用 GPU\n$ yhq | grep gpu"
    ]
}