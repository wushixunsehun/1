{
    "query": "请说明HPC4系统上安装CMAQ v5.4的步骤，详细说明从加载编译环境到完成CCTM模块编译期间，涉及到的关键软件依赖、环境变量配置和Makefile的修改要点。",
    "summaries": [
        "本文档记录了在HPC4系统上安装CMAQ_v5.4的过程，包括加载环境、安装netcdf-c和netcdf-fortran、配置ioapi以及最终的CMAQ编译。步骤涵盖软件依赖的安装与路径配置，并详细说明了各组件的编译过程，确保CMAQ能够正确运行。",
        "本文档记录了在HPC4平台上编译安装CMAQv5.0.2的过程。主要包括源码下载（CMAQ、ioapi、netcdf）、依赖环境配置（Intel编译器、netcdf和ioapi库）、编译步骤（包括netcdf、ioapi、CMAQ各模块的编译与链接）。通过设置环境变量、修改配置文件并执行编译脚本，最终完成CMAQ的安装。",
        "本文档记录了在3F系统上安装CMAQ_v5.4的过程，包括加载环境、安装netcdf-c、netcdf-fortran、ioapi及配置CMAQ。主要步骤包括下载源码、配置编译参数、修改Makefile和执行安装命令。过程中遇到编译错误，如“unrecognized command line option ‘-m64’”，需调整编译选项以解决。最终完成CMAQ_v5.4的安装与配置。"
    ],
    "contents": [
        "release version\npwd  #/thfs1/home/username/software/CMAQ_5.4/ioapi-3.2\nmkdir Linux2_x86_64gfort\nln -sf /thfs1/home/username/software/CMAQ_5.4/netcdf/lib/*.so Linux2_x86_64gfort/\ncp ioapi/Makefile.nocpl ioapi/Makefile\ncp m3tools/Makefile.nocpl m3tools/Makefile\ncp Makefile.template Makefile\nexport BIN=Linux2_x86_64ifort\n### 修改Makefile文件\nvi Makefile\nCPLMODE = nocpl\nBIN = Linux2_x86_64gfort\nBASEDIR = ${PWD}\nINSTALL = /thfs1/home/username/software/CMAQ_5.4/ioapi-3.2\nBININST = $(INSTALL)/bin\nLIBINST = $(INSTALL)/lib\nIOAPIDEFS =\nPVMINCL =\n### 修改Makeinclude.Linux2_x86_64ifort文件\nvi /thfs1/home/username/software/CMAQ_5.4/ioapi-3.2/ioapi/Makeinclude.Linux2_x86_64gfort  # 结合自己路径更改下列内容\nCC = mpicc\nCXX = mpicxx\nFC = mpifort\nMFLAGS    = -ffast-math -funroll-loops  ### 报错记录如下，所以要改\nmake configure\nmake all\nmake install\n(cd /thfs1/home/qs_songsj4/software/CMAQ_5.4/ioapi-3.2/ioapi  ; make BIN=Linux2_x86_64gfort al\n1)\nmake[ 1]: Entering directory '/thfs1/home/qs_songsj4/software/CMAQ_5.4/ioapi-3.2/ioapi\nif [ ! -d /thfs1/home/qs_songsj4/software/CMAQ_5.4/ioapi-3.2/Linux2_x86_64gfort ]; then mkdir -\np /thfs1/home/qs_songsj4/software/CMAQ_5.4/ioapi-3.2/Linux2_x86_64gfort; fi\ncd /thfs1/home/qs_songsj4/software/CMAQ_5.4/ioapi-3.2/Linux2_x86_64gfort; mpifort -c -DAUTO_ARR\nAYS=1 -DF90=1 -",
        "【已解决】HPC4编译安装CMAQ5.0.2\n**标签**: HPC4 CMAQ5.0.2\n**创建时间**: 2022-03-18 10:27:41\n**更新时间**: 2022-03-18 10:27:41\n**作者**: 张天奇\nCMAQv5.0.2在HPC4上的编译安装\n1.  **源码下载**：\n1.1  **CMAQ源码**：\nCommunity Multiscale Air Quality Modeling System (CMAQ)的官方下载地址在：https://www.epa.gov/cmaq/access-cmaq-source-code\n目前的版本4.7.1-5.3.3。\n1.2 **ioapi源码**:\nInput/Output Applications Programming Interface (I/O API)可以从CMAS官网\nhttps://www.cmascenter.org/download/forms/step_2.cfm?prod=5\n进行下载，本次编译选择3.2版本ioapip。\n1.3 **netcdf源码**：\nNetCDF (network Common Data Form)的官方下载地址在\nhttps://www.unidata.ucar.edu/downloads/netcdf/\n本次编译选择netCDF-fortran-4.4.5以及netCDF-C-4.6.2\n1.1  **CMAQ源码**：\nCommunity Multiscale Air Quality Modeling System (CMAQ)的官方下载地址在：https://www.epa.gov/cmaq/access-cmaq-source-code\n目前的版本4.7.1-5.3.3。\n1.2 **ioapi源码**:\nInput/Output Applications Programming Interface (I/O API)可以从CMAS官网\nhttps://www.cmascenter.org/download/forms/step_2.cfm?prod=5\n进行下载，本次编译选择3.2版本ioapip。\n1.3 **netcdf源码**：\nNetCDF (network Common Data Form)的官方下载地址在\nhttps://www.unidata.ucar.edu/downloads/netcdf/\n本次编译选择netCDF-fortran-4.4.5以及netCDF-C-4.6.2\n2.  **依赖环境**：\n基础环境：Intel_",
        "/CMAQ.git CMAQ_REPO\nmv CMAQ_REPO CMAQ_5.4\nmkdir CMAQ_Project\ncd CMAQ_5.4\ncp bldit_project.csh bldit_project.csh.old\n### 修改bldit_project.csh文件\nvi bldit_project.csh\nset CMAQ_HOME = /fs1/home/username/software/wrf-cmaq/CMAQ_Project\n### 执行/bldit_project.csh\n./bldit_project.csh\ncd /fs1/home/username/software/wrf-cmaq/CMAQ_Project\ncp config_cmaq.csh config_cmaq.csh.old\n### 修改config_cmaq.csh\nvi config_cmaq.csh\ncase intel:\nsetenv IOAPI_INCL_DIR   /fs1/home/username/software/wrf-cmaq/ioapi-3.2/ioapi/fixed_src\nsetenv IOAPI_LIB_DIR    /fs1/home/username/software/wrf-cmaq/ioapi-3.2/Linux2_x86_64ifort\nsetenv NETCDF_LIB_DIR   /fs1/home/username/software/wrf-cmaq/netcdf/lib\nsetenv NETCDF_INCL_DIR  /fs1/home/username/software/wrf-cmaq/netcdf/include\nsetenv NETCDFF_LIB_DIR  /fs1/home/username/software/wrf-cmaq/netcdf/lib\nsetenv NETCDFF_INCL_DIR /fs1/home/username/software/wrf-cmaq/netcdf/include\nsetenv MPI_INCL_DIR     /fs1/software/intel/2020.2/compilers_and_libraries_2020.2.254/linux/mpi/intel64/include\nsetenv MPI_LIB_DIR      /fs1/software/intel/2020.2/compilers_and_libraries_2020.2.254/linux/mpi/intel64/lib\nsetenv myLINK_FLAG \"-qopenmp\"\n### 执行config_cmaq.csh\n./config_cmaq.csh intel  # 执行完成后，在当前目录会新建lib目录，上述环境会整合到当前目录。\n2）CMAQ模式主要包含4个模块，分别是前处理mcip、icon、bcon和核心模块cctm，依次进行编译。\n# step1：",
        "fi\ncd /thfs1/home/qs_songsj4/software/CMAQ_5.4/ioapi-3.2/Linux2_x86_64gfort; mpifort -c -DAUTO_ARR\nAYS=1 -DF90=1 -DFLDMN=1 -DFSTR_L=int -DIOAPI_NO_STDOUT=1  -DNEED ) ARGS=1 -03 -ffast-math -funrol\nl-loops -m64   -fopenmp -DAUTO | ARRAYS=1  -DF90=1 -DFLDMN=1  -DFSTR_| L=int -DIOAPI_NO_STDOUT=1 -DNE\nED_ARGS=1 -I/thfs1/home/qs_songsj4/software/CMAQ_5. 4/ioapi-3. 2/ioapi /thfs1/home/qs_songsj4/sot\ntware/CMAQ_5.4/ioapi-3.2/ioapi/m3utilio.f\ngfortran: error: unrecognized command line option ‘-m64’\nmake[ 1]: *** [Makefile:277: m3utilio.o] Error 1\nmake[ 1]: Leaving directory '/thfs1/home/qs_songsj4/software/CMAQ_5.4/ioapi-3.2/ioapi\nmake: *** [Makefile:209: all] Error 2\n5、安装CMAQ_v5.4\n1）配置CMAQ\ngit clone -b main https://github.com/USEPA/CMAQ.git CMAQ_REPO\ncd CMAQ_REPO\ncp bldit_project.csh bldit_project.csh.old\n### 修改bldit_project.csh文件\nvi bldit_project.csh\nset CMAQ_HOME = /thfs1/home/username/software/CMAQ_5.4/CMAQ_REPO\n### 执行/bldit_project.csh\n./bldit_project.csh\ncd /thfs1/home/username/software/CMAQ_5.4/CMAQ_REPO\ncp config_cmaq.csh config_cmaq.csh.old\n### 修改config_cmaq.csh\nvi config_cmaq.csh\ncase gcc:\nsetenv IOAPI_INCL_DIR   /thfs1/home/username",
        "【已解决】3F系统安装CMAQ_v5.4\n**标签**: 无标签\n**创建时间**: 2024-08-01 10:15:30\n**更新时间**: 2024-08-02 11:07:02\n**作者**: 杜佳伟\n1、加载环境\nmodule add loginnode/loginnode proxy/proxy GCC/9.3.0 openmpi/mpi-x-gcc9.3.0\n注：软件安装路径/thfs1/home/username/software/CMAQ_5.4\n2、安装netcdf-c\n下载地址：https://downloads.unidata.ucar.edu/netcdf/\ntar -zxvf netcdf-c-4.9.2.tar.gz\ncd netcdf-c-4.9.2\nCC=gcc CXX=g++ FC=gfortran ./configure prefix=/thfs1/home/username/software/CMAQ_5.4/netcdf disable-dap disable-netcdf-4\nmake -j8\nmake check install |& tee make.install.log.txt\n3、安装netcdf-fortran\ntar -zxvf netcdf-fortran-4.5.3.tar.gz\ncd netcdf-fortran-4.5.3\nCC=gcc CXX=g++ FC=gfortran ./configure prefix=/thfs1/home/username/software/CMAQ_5.4/netcdf CPPFLAGS='-I/thfs1/home/username/software/CMAQ_5.4/netcdf/include' LDFLAGS='-L/thfs1/home/username/software/CMAQ_5.4/netcdf/lib'\nmake -j8\nmake install |& tee make.install.log.txt\n4、安装ioapi\ngit clone https://github.com/cjcoats/ioapi-3.2\ncd ioapi-3.2         #change directory to ioapi-3.2\ngit checkout -b 20200828   #change branch to 20200828 for a tagged release version\npwd  #/thfs1/home/username/software/CMAQ_5.4/ioapi-3.2\nmkdir Linux2_x86_64gfort\nln -sf /thfs1/home/username/software/CMAQ_",
        "${netcdf安装路径} netcdf\ncp -r ${ioapi安装路径} ioapi_3.1\ncp -r ${mpi安装路径} mpich\ncd scripts/build\n./bldit.bldmake\n```\n编译pario\n```\ncd scripts/pario\nvi bldit.pario\nset IOAPIEXT = ${ioapi安装路径}/ioapi/fixed_src\nset IOAPIMOD = ${ioapi安装路径}/Linux2_x86_64ifort\n保存退出后\n./bldit.pario\n```\n编译stenex\n```\ncd scripts/stenex\n./bldit.se\ncd scripts/jproc\nvi bldit.jproc\nset LIOAPI  = \"${M3LIB}/ioapi_3.1/Linux2_x86_64ifort -lioapi\"\nset IOAPIMOD = ${M3LIB}/ioapi_3.1/Linux2_x86_64ifort\n保存退出后\n./bldit.jproc,在BLD_D502a中生成JPROC_D502a_Linux4_x86_64intel\n```\n编译ICON\n```\ncd scripts/icon\nvi bldit.icon\nset IOAPI  = \"${M3LIB}/ioapi_3.1/Linux2_x86_64ifort -lioapi\"\nset IOAPIMOD = ${M3LIB}/ioapi_3.1/Linux2_x86_64ifort\nset NETCDF = \"${M3LIB}/netcdf/lib -lnetcdf -lnetcdff\"\n保存退出后\n./bldit.icon,在BLD_D502a生成ICON_D502a_Linux4_x86_64intel\ncd scripts/bcon\n```\n编译BCON\n```\nvi bldit.bcon\nset IOAPI  = \"${M3LIB}/ioapi_3.1/Linux2_x86_64ifort -lioapi\"\nset IOAPIMOD = ${M3LIB}/ioapi_3.1/Linux2_x86_64ifort\nset NETCDF = \"${M3LIB}/netcdf/lib -lnetcdf -lnetcdff\"\n保存退出后\n./bldit.bcon,在BLD_D502a生成BCON_D502a_Linux4_x86_64intel\n```\n编译mcip\n```\ncd scripts/mcip/src\nvi Makefile\nNETCDF = ${netcdf安装",
        "/www.unidata.ucar.edu/downloads/netcdf/\n本次编译选择netCDF-fortran-4.4.5以及netCDF-C-4.6.2\n2.  **依赖环境**：\n基础环境：Intel_compiler/19.1.2，\n依赖环境：netcdf-C-4.6.2,netcdf-fortran-4.4.5,ioapi-3.2\n基础环境：Intel_compiler/19.1.2，\n依赖环境：netcdf-C-4.6.2,netcdf-fortran-4.4.5,ioapi-3.2\n3.  **编译安装**：\n参考安装步骤：\n[CMAQ编译安装](https://alei817927.gitbooks.io/guild-book/content/tech/compile_and_install.html)\n[5.0.2在3F上的编译安装](http://172.31.2.213/#/article/article_detail/94)\n3.1 **编译netcdf**：\n3.2 **编译ioapi**：\n3.3 **编译CMAQ**：\n准备工作\n```\nunzip CMAQ-5.0.2.zip\nexport M3HOME=${CMAQ安装目录}\nexport M3MODEL=${M3HOME}/models\nexport M3DATA=${M3HOME}/data\nexport M3LIB=${M3HOME}/lib\n```\n编译器设置\n```\ncd CMAQ-5.0.2/scripts\nvi config.cmaq\nsetenv M3HOME ${CMAQ安装路径}\nsetenv COMPILER intel\n#setenv mpi \"-lmpich\"\nsetenv mpi \"-lmpi\"\nsetenv myLINK_FLAG \"-static-intel -qopenmp\"\nsetenv myFFLAGS \"-fixed -132 -O3 -qoverride-limits -fno-alias -mp1 -fp-model precise\"\nsetenv myFC mpiifort\nsetenv myCC mpiicc\n保存退出后：\nsource config.cmaq\n```\n链接/复制依赖库\n```\ncd ${M3LIB}\ncp -r ${netcdf安装路径} netcdf\ncp -r ${ioapi安装路径} ioapi_3.1\ncp -r ${mpi安装路径} mpich\ncd scripts/build\n./bldit.bldmake",
        "【已解决】HPC4系统安装CMAQ_v5.4\n**标签**: 无标签\n**创建时间**: 2024-08-01 09:25:12\n**更新时间**: 2024-08-02 09:46:43\n**作者**: 杜佳伟\n1、加载环境\nmodule add Intel_compiler/19.1.2\nmodule add MPI/Intel/IMPI/2019.8.254\n注：软件安装路径/fs1/home/username/software/wrf-cmaq\n2、安装netcdf-c\n下载地址：https://downloads.unidata.ucar.edu/netcdf/\ntar -zxvf netcdf-c-4.9.2.tar.gz\ncd netcdf-c-4.9.2\nCC=icc CXX=icc FC=ifort CPP='icpc -E' ./configure prefix=/fs1/home/username/software/wrf-cmaq/netcdf disable-dap disable-netcdf-4\nmake -j8\nmake check install |& tee make.install.log.txt\n3、安装netcdf-fortran\ntar -zxvf netcdf-fortran-4.6.1.tar.gz\ncd netcdf-fortran-4.6.1\nCC=icc CXX=icc FC=ifort CPP='icpc -E' ./configure prefix=/fs1/home/username/software/wrf-cmaq/netcdf CPPFLAGS='-I/fs1/home/username/software/wrf-cmaq/netcdf/include' LDFLAGS='-L/fs1/home/username/software/wrf-cmaq/netcdf/lib'\nmake -j8\nmake install |& tee make.install.log.txt\n4、安装ioapi\ngit clone https://github.com/cjcoats/ioapi-3.2\ncd ioapi-3.2         #change directory to ioapi-3.2\ngit checkout -b 20200828   #change branch to 20200828 for a tagged release version\npwd  #/fs1/home/username/software/wrf-cmaq/ioapi-3.2\nmkdir Linux2_x86_64ifort\nln",
        "#change branch to 20200828 for a tagged release version\npwd  #/fs1/home/username/software/wrf-cmaq/ioapi-3.2\nmkdir Linux2_x86_64ifort\nln -sf /fs1/home/username/software/wrf-cmaq/netcdf/lib/*.so Linux2_x86_64ifort/\ncp ioapi/Makefile.nocpl ioapi/Makefile\ncp m3tools/Makefile.nocpl m3tools/Makefile\ncp Makefile.template Makefile\nexport BIN=Linux2_x86_64ifort\n### 修改Makefile文件\nvi Makefile\nCPLMODE = nocpl\nBIN = Linux2_x86_64ifort\nBASEDIR = ${PWD}\nINSTALL = /fs1/home/username/software/wrf-cmaq/ioapi-3.2\nBININST = $(INSTALL)/bin\nLIBINST = $(INSTALL)/lib\nIOAPIDEFS =\nPVMINCL =\nNCFLIBS    = -lnetcdff -lnetcdf\nIODIR      = $(BASEDIR)/ioapi\nFIXDIR     = $(IODIR)/fixed_src\nHTMLDIR    = $(BASEDIR)/HTML\nTOOLDIR    = $(BASEDIR)/m3tools\nOBJDIR     = $(BASEDIR)/$(BIN)\n### 修改Makeinclude.Linux2_x86_64ifort文件\nvi /fs1/home/username/software/wrf-cmaq/ioapi-3.2/ioapi/Makeinclude.Linux2_x86_64ifort  # 结合自己路径更改为下列内容\nCC = mpiicc\nCXX = mpiicpc\nFC = mpiifort -auto -warn notruncated_source -static-intel\nOMPFLAGS = -qopenmp\nOMPLIBS = -qopenmp\n#ARCHLIB = -Bstatic\nmake configure\nmake all\nmake install\n5、安装CMAQ_v5.4\n1）配置CMAQ\ngit clone -b main https://github.com/USEPA/CMAQ.git CMAQ_REPO\nmv CMAQ_REPO CMAQ_5.4\nmkdir CMAQ_Project\ncd CMAQ_5.4\ncp bldit_project.csh bldit_project.csh.old\n### 修改"
    ]
}